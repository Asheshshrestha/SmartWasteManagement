if (self.CavalryLogger) { CavalryLogger.start_js(["xsjWl"]); }

__d("SpotlightViewerBottomBar",["cx","LeftRight.react","React","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=Array.isArray(this.props.children)?this.props.children:[this.props.children],c="_4_8n _51an";this.props.className&&(c=b("joinClasses")(c,this.props.className));if(a.length===1)return b("React").jsx("div",{className:c,children:a[0]});c=b("joinClasses")(c,"_50-m");return b("React").jsxs(b("LeftRight.react"),{className:c,children:[a[0],a[1]]})};return c}(b("React").Component);e.exports=a}),null);
__d("SpotlightViewerBottomBarGroup",["cx","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props.itemmargin||"right";a=(a=="left"?"marginLeft":"")+(a=="right"?" marginRight":"")+" _4_8i";return b("React").jsx("div",{className:a,children:this.props.children})};return c}(b("React").Component);e.exports=a}),null);
__d("MessagingVideoViewer.react",["cx","fbt","ActorURI","ArbiterMixin","AsyncRequest","MessagingForwardingButtonNUX.react","PageTransitionsRegistrar","PhotoViewerDimensions","React","ReactFragment","SpotlightViewer","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerClose","SpotlightViewport","Vector","XMessagingVideoAttachmentController","guid","prop-types"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=200;c=b("React").createClass({displayName:"MessagingVideoViewer",propTypes:{disableForward:(a=b("prop-types")).bool,forwardDialogComponent:a.func.isRequired,pageID:a.number,rootClassName:a.string,videoSize:a.instanceOf(b("Vector")).isRequired,videoID:a.string.isRequired,videoURI:a.string.isRequired},mixins:[b("ArbiterMixin")],getInitialState:function(){var a=new(b("PhotoViewerDimensions"))({verticalPadding:i});return{dimensions:a.getStageDimensions(this.props.videoSize),loading:!0,open:!0,showForward:!1}},UNSAFE_componentWillMount:function(){this._domID=b("guid")()},componentDidMount:function(){var a=this;this._loadVideoPlayer();b("PageTransitionsRegistrar").registerCompletionCallback(function(){a.close();return!0})},_loadVideoPlayer:function(){var a=this,c=b("XMessagingVideoAttachmentController").getURIBuilder().setString("video_id",this.props.videoID).setString("video_container_id",this._domID).setInt("width",this.state.dimensions.x).setInt("height",this.state.dimensions.y).getURI();this.props.pageID&&(c=b("ActorURI").create(c,this.props.pageID));this.request=new(b("AsyncRequest"))().setMethod("GET").setURI(c).setReadOnly(!0).setHandler(function(b){return a.setState({loading:!1})}).send()},close:function(){if(!this.state.open)return;this.setState({open:!1},function(){this.inform("close")})},_showForwardDialog:function(){this.setState({showForward:!0}),this.refs.forwardNUX.close()},_hideForwardDialog:function(){this.setState({showForward:!1})},renderLayers:function(){var a=this;if(this.props.disableForward)return null;var c=h._("Forward in separate messages"),d=this.props.forwardDialogComponent;return b("ReactFragment").create({forwardDialog:b("React").jsx(d,{attachmentID:this.props.videoID,onClose:this._hideForwardDialog,shown:this.state.showForward,title:c}),forwardButtonNUX:b("React").jsx(b("MessagingForwardingButtonNUX.react"),{contextRef:function(){return a.refs.forwardButton},ref:"forwardNUX",children:h._("Send this video to other people in separate messages.")})})},render:function(){var a=b("React").jsx("div",{className:"rfloat",id:this._domID}),c;this.props.disableForward||(c=b("React").jsx(b("SpotlightViewerBottomBarLink"),{onClick:this._showForwardDialog,ref:"forwardButton",children:h._("Forward")}));return b("React").jsxs("span",{children:[b("React").jsx(b("SpotlightViewer"),{onHide:this.close,open:this.state.open,rootClassName:this.props.rootClassName,children:b("React").jsxs(b("SpotlightViewport"),{active:!0,className:"_39hc",media:a,showLoadingIndicator:this.state.loading,stageDimensions:this.state.dimensions,useWidth:!0,children:[b("React").jsx(b("SpotlightViewerClose"),{onClick:this.close}),b("React").jsxs(b("SpotlightViewerBottomBar"),{className:"stat_elem",children:[b("React").jsx(b("SpotlightViewerBottomBarGroup"),{}),b("React").jsxs(b("SpotlightViewerBottomBarGroup"),{children:[c,b("React").jsx(b("SpotlightViewerBottomBarLink"),{s:"true",href:this.props.videoURI,children:h._("Download")})]})]})]})}),this.renderLayers()]})}});e.exports=c}),null);
__d("SpotlightMessagesViewer",["fbt","ActorURI","ArbiterMixin","MessagingForwardingButtonNUX.react","PageTransitionsRegistrar","React","ReactFragment","SpotlightViewer","SpotlightViewerAutoResize","SpotlightViewerBehaviorsMixin","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerClose","SpotlightViewerCoreMixin","SpotlightViewerDimensionMixin","SpotlightViewerPagers","SpotlightViewerPageWithKeys","SpotlightViewerThumbnailMixin","SpotlightViewport","SubscriptionsHandler","XMessagingPhotoDownloadController"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").createClass({displayName:"SpotlightMessagesViewer",mixins:[b("ArbiterMixin"),b("SpotlightViewerBehaviorsMixin"),b("SpotlightViewerCoreMixin"),b("SpotlightViewerThumbnailMixin"),b("SpotlightViewerDimensionMixin")],behaviors:[b("SpotlightViewerPageWithKeys"),b("SpotlightViewerAutoResize")],componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release(),this._subscriptions=null},getViewerID:function(){return this.props.setid},getInitialState:function(){this._subscriptions=new(b("SubscriptionsHandler"))();return{photoData:this._getInitialPhotoData(),open:!0,showForward:!1}},_enableSubscriptions:function(){var a=this;this.props.useloadingindicator&&this._subscriptions.addSubscriptions(this.viewState.subscribe("photo_fetch",function(){return a.setState({photoData:null})}))},_showForwardDialog:function(){this.setState({showForward:!0}),this.refs.forwardNUX.close()},_hideForwardDialog:function(){this.setState({showForward:!1})},renderLayers:function(){var a=this;if(this.props.disableForward)return null;var c=g._("Forward in separate messages"),d=this.props.forwardDialogComponent;return b("ReactFragment").create({forwardDialog:b("React").jsx(d,{attachmentID:String(this.state.photoData.id),onClose:this._hideForwardDialog,shown:this.state.showForward,title:c}),forwardButtonNUX:b("React").jsx(b("MessagingForwardingButtonNUX.react"),{contextRef:function(){return a.refs.forwardButton},ref:"forwardNUX",children:g._("Send this image to other people in separate messages.")})})},render:function(){var a=this,c=this.getMedia(),d=this.props.snapToPhoto?this.getImageDimensions():this.getStageDimensions();d.x=Math.max(d.x,185);d.y=Math.max(d.y,185);var e=this.props.useloadingindicator&&!this.state.photoData;b("PageTransitionsRegistrar").registerCompletionCallback(function(){a.state.open&&a.close();return!0});return b("React").jsxs("span",{children:[b("React").jsx(b("SpotlightViewer"),{rootClassName:this.props.rootClassName,open:this.state.open,onHide:this.close,children:b("React").jsxs(b("SpotlightViewport"),{active:!1,onClick:this._onClickViewport,stageDimensions:d,media:c,showLoadingIndicator:e,useWidth:!0,children:[b("React").jsx(b("SpotlightViewerClose"),{onClick:this.close}),this.props.disablepaging?null:b("React").jsx(b("SpotlightViewerPagers"),{}),this._renderBottomBar()]})}),this.renderLayers()]})},_renderBottomBar:function(){var a;this.props.disableForward||(a=b("React").jsx(b("SpotlightViewerBottomBarLink"),{onClick:this._showForwardDialog,ref:"forwardButton",children:g._("Forward")}));var c=b("XMessagingPhotoDownloadController").getURIBuilder().setString("photo_id",String(this.state.photoData.id)).getURI();this.props.actorid&&(c=b("ActorURI").create(c,this.props.actorid));return b("React").jsxs(b("SpotlightViewerBottomBar"),{children:[b("React").jsx(b("SpotlightViewerBottomBarGroup"),{}),b("React").jsxs(b("SpotlightViewerBottomBarGroup"),{children:[a,b("React").jsx(b("SpotlightViewerBottomBarLink"),{rel:"async",ajaxify:c,children:g._("Download")})]})]})}});e.exports=a}),null);