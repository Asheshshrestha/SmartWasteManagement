if (self.CavalryLogger) { CavalryLogger.start_js(["4eFD9"]); }

__d("H264Parser",["DataViewReader"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=function(){__p&&__p();function a(b){this.$1=b.readUint8(),this.$2=b.readUint16(),this.$5=null,this.$3=null,this.$4=null,this.$2===a.ATSC&&(this.$3=b.readChars(4)),(this.$2===a.ATSC||this.$2===a.DIRECTV)&&(this.$4=b.readUint8()),this.$2===a.DIRECTV&&(this.$5=b.readUint8())}var b=a.prototype;b.getProviderCode=function(){return this.$2};b.getCountryCode=function(){return this.$1};b.getATSC1UserDataType=function(){return this.$4};return a}();g.ATSC=49;g.DIRECTV=47;var h=function(){function a(a){this.$2=a.readUint8(),this.$1=a.readUint8()}var b=a.prototype;b.getPayloadType=function(){return this.$2};b.getPayloadSize=function(){return this.$1};return a}();h.UserDataRegisteredItuT35=4;var i=function(){__p&&__p();function a(a){this.$1=a.getCursor();this.$2=a.readUint32();this.$3=a.readUint8();if(128&this.$3)throw new Error("Forbiddon zero bit was 1")}var b=a.prototype;b.getStart=function(){return this.$1};b.getSize=function(){return this.$2+4};b.getType=function(){return this.$3&31};b.getRefIdc=function(){return(this.$3&96)>>5};return a}();i.SupplementalEnhancementInformation=6;var j=function(){__p&&__p();function a(a){var b=a.readUint8(),c=248&b;if(c!==248)throw new Error("Invalid marker bits");this.$1=!!(4&b);this.$2=3&b;this.$3=a.readUint8();this.$4=a.readUint8()}var b=a.prototype;b.isValid=function(){return this.$1};b.getData1=function(){return this.$3};b.getData2=function(){return this.$4};b.getType=function(){return this.$2};return a}(),k=function(){__p&&__p();function a(a){__p&&__p();var b=a.readUint8();this.$1=!!(128&b);this.$2=!!(64&b);this.$3=!!(32&b);this.$5=31&b;this.$6=a.readUint8();this.$4=a.getCursor();a.skip(this.$5*3);b=a.readUint8();if(b!=255)throw new Error("Invalid marker bits")}var b=a.prototype;b.getCaptionsDataStart=function(){return this.$4};b.getCaptionsCount=function(){return this.$5};return a}();a=function(){__p&&__p();function a(a){this.$2=new(b("DataViewReader"))(a),this.$1=this.$2.getCursor()}var c=a.prototype;c.parseNALUnit=function(){return new i(this.$2)};c.parseSEIUnit=function(){return new h(this.$2)};c.parseUserDataRegisteredItuT35=function(){return new g(this.$2)};c.parseUserData=function(){return new k(this.$2)};c.parseClosedCaptionDataPacket=function(){return new j(this.$2)};c.parseClosedCaptionDataPackets=function(a){var b=[],c=this.$2.getCursor();this.$2.seek(a.getCaptionsDataStart());a=a.getCaptionsCount();while(a--)b.push(this.parseClosedCaptionDataPacket());this.$2.seek(c);return b};c.hasCursorIncreased=function(){var a=this.$1;this.$1=this.$2.getCursor();return a<this.$2.getCursor()};c.atEnd=function(){return this.$2.getCursor()>=this.$2.getDataView().byteLength};c.skipNALU=function(a){this.$2.seek(a.getStart()+a.getSize())};return a}();e.exports=a}),null);
__d("Mp4Box",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.$4=a.getCursor(),this.$1=a.readUint32(),this.$2=a.readChars(4),this.$1===1?this.$1=a.readUint64():this.$1===0&&(this.$1=a.getDataView().byteLength-this.$4),this.$2==="uuid"&&(this.$3=a.readChars(16)),this.$5=a.getCursor()}var b=a.prototype;b.getBodyStart=function(){return this.$5};b.getBodySize=function(){var a=this.$5-this.$4;return this.getSize()-a};b.getSize=function(){return this.$1};b.getType=function(){return this.$2};b.getUuid=function(){return this.$3};b.getStart=function(){return this.$4};b.inspect=function(){return"{ size: "+this.$1+", type: "+this.$2+" }"};return a}();e.exports=a}),null);
__d("Mp4FullBox",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a,b){this.$2=a.readUint8(),this.$1=a.readUint8(),this.$1=a.readUint8()+(this.$1<<8),this.$1=a.readUint8()+(this.$1<<8),this.$3=b}var b=a.prototype;b.getVersion=function(){return this.$2};b.getFlags=function(){return this.$1};b.getBox=function(){return this.$3};return a}();e.exports=a}),null);
__d("Mp4Demuxer",["DataViewReader","Mp4Box","Mp4FullBox"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.$1=new(b("DataViewReader"))(a)}var c=a.prototype;c.parseBox=function(){return new(b("Mp4Box"))(this.$1)};c.parseFullBox=function(a){return new(b("Mp4FullBox"))(this.$1,a)};c.parseCanonicalBox=function(a,b){return new a(this.$1,b)};c.skipBox=function(a){this.$1.seek(a.getStart()+a.getSize())};c.withinBox=function(a){var b=this.$1.getCursor();return b>=a.getStart()&&b<a.getStart()+a.getSize()};c.atEnd=function(){return this.$1.getCursor()>=this.$1.getDataView().byteLength};c.reset=function(){this.$1.seek(0)};return a}();e.exports=a}),null);
__d("Mp4FragmentSampleMap",["invariant"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,b,c,d,e,f){__p&&__p();f===void 0&&(f=0);this.$1=a.reduce(function(a,b){return a+b.samples.length},0);this.$3=0;this.$5=0;this.$2=0;this.$7=e;this.$8=d;this.$6=a;this.$10=b;this.$11=f;this.$4=0;this.$9=c;e=this.$6[this.$5].offset;this.$10!==null&&e!==null&&(this.$9=this.$10+e)}var b=a.prototype;b.getCurrentSampleOffset=function(){var a=this.$6[this.$5];return this.$10+(a.offset||0)+this.$9};b.$12=function(){var a=this.$6[this.$5];return a.samples[this.$3]};b.getCurrentSampleSize=function(){var a=this.$12().sampleSize;if(a!==null)return a;this.$7||g(0,3342);return this.$7};b.$13=function(){var a=this.$12().sampleDuration;return a!==null?a:this.$8||0};b.getCurrentSampleDecodingTime=function(){return this.$4+this.$11};b.$14=function(){var a=this.$12().sampleCompositionTimeOffset;return a||0};b.getCurrentSampleCompositionTime=function(){return this.getCurrentSampleDecodingTime()+this.$14()};b.nextSample=function(){__p&&__p();if(this.$2+1>=this.$1)return!1;this.$9+=this.getCurrentSampleSize();this.$4+=this.$13();this.$3+=1;this.$2+=1;var a=this.$6[this.$5];if(this.$3>=a.samples.length){this.$5++;var b=this.$9;this.$10!==null&&a.offset!=null&&(b=this.$10+a.offset);this.$9=b;this.$3=0}return!0};return a}();e.exports=a}),null);
__d("Mp4TrackFragmentBaseMediaDecodeTimeBox",[],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";function a(a,b){this.$1=b,b.getVersion()===1?this.$2=a.readUint64():this.$2=a.readUint32()}var b=a.prototype;b.getBaseDecodeTime=function(){return this.$2};b.getFullBox=function(){return this.$1};return a}();a.canonicalType="tfdt";e.exports=a}),null);
__d("Mp4TrackFragmentHeaderBox",[],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,b){__p&&__p();this.$1=b;this.$2=a.readUint32();b=b.getFlags();this.$3=null;this.$4=null;this.$5=null;this.$6=null;this.$7=null;b&1&&(this.$3=a.readUint64());b&2&&(this.$4=a.readUint32());b&8&&(this.$5=a.readUint32());b&16&&(this.$6=a.readUint32());b&32&&(this.$7=a.readUint32())}var b=a.prototype;b.getTrackID=function(){return this.$2};b.getDefaultSampleSize=function(){return this.$6};b.getDefaultSampleDuration=function(){return this.$5};b.getSampleDescriptionIndex=function(){return this.$4};b.isDurationEmpty=function(){return!!(this.$1.getFlags()&65536)};b.getFullBox=function(){return this.$1};b.getBaseDataOffset=function(){return this.$3};return a}();a.canonicalType="tfhd";e.exports=a}),null);
__d("Mp4TrackRunBox",[],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,b){__p&&__p();this.$1=b;this.$2=a.readUint32();b=b.getFlags();b&1&&(this.$3=a.readInt32());b&4&&(this.$4=a.readUint32());var c=0;this.$5=new Array(this.$2);while(c<this.$2){var d={sampleDuration:null,sampleSize:null,sampleFlags:null,sampleCompositionTimeOffset:null};b&256&&(d.sampleDuration=a.readUint32());b&512&&(d.sampleSize=a.readUint32());b&1024&&!(b&4)&&(d.sampleFlags=a.readUint32());b&2048&&(d.sampleCompositionTimeOffset=a.readUint32());this.$5[c++]=d}}var b=a.prototype;b.getSamples=function(){return this.$5};b.getSampleCount=function(){return this.$2};b.getDataOffset=function(){return this.$3};b.getFirstSampleFlags=function(){return this.$4};b.getFullBox=function(){return this.$1};return a}();a.canonicalType="trun";e.exports=a}),null);
__d("CEA608ByteListExtractor",["Promise","FBLogger","H264Parser","Mp4Demuxer","Mp4FragmentSampleMap","Mp4TrackFragmentBaseMediaDecodeTimeBox","Mp4TrackFragmentHeaderBox","Mp4TrackRunBox","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){__p&&__p();a=new DataView(a);a=new(b("Mp4Demuxer"))(a);var c={mdat:null,truns:[],tfhd:null,moofOffset:null,tfdt:null};while(!a.atEnd()){var d=a.parseBox();switch(d.getType()){case"mdat":c.mdat=d;a.skipBox(d);break;case b("Mp4TrackFragmentHeaderBox").canonicalType:var e=a.parseCanonicalBox(b("Mp4TrackFragmentHeaderBox"),a.parseFullBox(d));if(!(e instanceof b("Mp4TrackFragmentHeaderBox"))){b("recoverableViolation")("[CEA608ByteListExtractor] Expected tfhd to be Mp4TrackFragmentHeaderBox","video_captions");return c}c.tfhd=e;a.skipBox(d);break;case b("Mp4TrackRunBox").canonicalType:e=a.parseCanonicalBox(b("Mp4TrackRunBox"),a.parseFullBox(d));if(!(e instanceof b("Mp4TrackRunBox"))){b("recoverableViolation")("[CEA608ByteListExtractor] Expected trun to be Mp4TrackRunBox","video_captions");return c}c.truns.push(e);a.skipBox(d);break;case b("Mp4TrackFragmentBaseMediaDecodeTimeBox").canonicalType:e=a.parseCanonicalBox(b("Mp4TrackFragmentBaseMediaDecodeTimeBox"),a.parseFullBox(d));if(!(e instanceof b("Mp4TrackFragmentBaseMediaDecodeTimeBox"))){b("recoverableViolation")("[CEA608ByteListExtractor] Expected tfdt to be Mp4TrackFragmentBaseMediaDecodeTimeBox","video_captions");return c}c.tfdt=e;a.skipBox(d);break;case"moof":c.moofOffset=d.getStart();case"traf":break;default:a.skipBox(d)}}return c}function h(a,c,d){__p&&__p();var e=null,f=[];do{var g=c.getCurrentSampleOffset();if(e!==null&&!(g>e)){b("recoverableViolation")("[CEA608ByteListExtractor] Busy-loop detected by lastSampleOffset","video_captions");break}e=g;g=new DataView(a.buffer,g,c.getCurrentSampleSize());g=new(b("H264Parser"))(g);while(!g.atEnd()){var h=g.parseNALUnit(),i=h.constructor.SupplementalEnhancementInformation;if(h.getType()===i){i=g.parseSEIUnit();var j=i.constructor.UserDataRegisteredItuT35;if(i.getPayloadType()===j){i=g.parseUserDataRegisteredItuT35();if(i.getProviderCode()===i.constructor.ATSC&&i.getATSC1UserDataType()===3){j=g.parseUserData();i=g.parseClosedCaptionDataPackets(j);j=[];var k=c.getCurrentSampleCompositionTime()/d;for(var l=0;l<i.length;l++){var m=i[l];m.isValid()&&m.getType()===0&&j.push(m.getData1(),m.getData2())}f.push({time:k,bytePairsFlat:j})}}}g.skipNALU(h)}if(!g.hasCursorIncreased()){b("recoverableViolation")("[CEA608ByteListExtractor] Busy-loop detected by hasCursorIncreased","video_captions");break}}while(c.nextSample());f.sort(function(a,b){return a.time-b.time});return f}a={extract:function(a){__p&&__p();return new(b("Promise"))(function(c,d){__p&&__p();d=g(a.videoBytes);var e=d.mdat,f=d.truns,i=d.tfhd,j=d.moofOffset;d=d.tfdt;if(!e){b("FBLogger")("video_captions").warn("[CEA608ByteListExtractor] Missing mdat");c([]);return}e=null;var k;if(f.length&&i&&d&&j!==null){e=new(b("Mp4FragmentSampleMap"))(f.map(function(a){return{offset:a.getDataOffset(),samples:a.getSamples()}}),i.getBaseDataOffset(),j,i.getDefaultSampleDuration(),i.getDefaultSampleSize(),d.getBaseDecodeTime());k=new DataView(a.videoBytes);k=h(k,e,a.timescale);c(k)}else{e=[[!f.length,"truns.length"],[!i,"tfhd"],[!d,"tfdt"],[j===null,"moofOffset"]].filter(function(a){var b=a[0];a[1];return b}).map(function(a){a[0];a=a[1];return a});e.length&&b("FBLogger")("video_captions").warn("[CEA608ByteListExtractor] Missing "+e.join(", "));c([])}})}};e.exports=a}),null);
__d("VideoPlayerCea608Command",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({TEXT:"text",PAC:"pac",MIDROW:"midrow",CARRIAGE_RETURN:"carriage_return",START_ROLL_UP_2:"start_roll_up_2",START_ROLL_UP_3:"start_roll_up_3",START_ROLL_UP_4:"start_roll_up_4",END_OF_CAPTION:"end_of_caption",ERASE_DISPLAY_MEMORY:"erase_display_memory",ERASE_NON_DISPLAY_MEMORY:"erase_non_display_memory",BACKSPACE:"backspace",DELETE_TIL_END_OF_ROW:"delete_til_end_of_row",RESUME_DIRECT_CAPTIONING:"resume_direct_captioning",RESUME_CAPTION_LOADING:"resume_caption_loading",TAB_OFFSET:"tab_offset",FLASH_ON:"flash_on",__DEPRECATED__ALARM_OFF:"alarm_off",__DEPRECATED__ALARM_ON:"alarm_on",__DEPRECATED__TEXT_RESTART:"text_restart",__DEPRECATED__RESUME_TEXT_DISPLAY:"resume_text_display"});e.exports=a}),null);
__d("CEA608Extractor",["invariant","Promise","CEA608ByteListExtractor","VideoPlayerCea608Command"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){a=a;a-=a>>1&85;a=(a&51)+(a>>2&51);return a+(a>>4)&15}function a(a,b){return"("+a.toString(10).padStart(3," ")+","+b.toString(10).padStart(3," ")+")"+(" (0x"+a.toString(16)+",0x"+b.toString(16)+")")+(" (0b"+a.toString(2).padStart(8,"0")+",0b"+b.toString(2).padStart(8,"0")+")")+(" ("+JSON.stringify(String.fromCharCode(a))+","+JSON.stringify(String.fromCharCode(b))+")")}function i(a,c,d){__p&&__p();a=a;var e=c,f=null;if((a===17||a===25)&&32<=e&&e<=47){a===17?f=1:f=2;e={flash:!1,underline:c%2===1,italics:c>=46,foreground:"white"};if(!e.italics){a=Math.floor(c/2)-16;c=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=c[a]}return[{type:b("VideoPlayerCea608Command").TEXT,data:{chNr:f,character:" "},presentationTime:d},{type:b("VideoPlayerCea608Command").MIDROW,data:{chNr:f,midrowData:e},presentationTime:d}]}return[]}var j=(c={},c[17]=1,c[18]=3,c[21]=5,c[22]=7,c[23]=9,c[16]=11,c[19]=12,c[20]=14,c),k=(d={},d[17]=2,d[18]=4,d[21]=6,d[22]=8,d[23]=10,d[19]=13,d[20]=15,d),l=(f={},f[25]=1,f[26]=3,f[29]=5,f[30]=7,f[31]=9,f[24]=11,f[27]=12,f[28]=14,f),m=(a={},a[25]=2,a[26]=4,a[29]=6,a[30]=8,a[31]=10,a[27]=13,a[28]=15,a);function n(a,c,d){__p&&__p();a=a;c=c;var e=null,f=(17<=a&&a<=23||25<=a&&a<=31)&&64<=c&&c<=127,g=(a===16||a===24)&&64<=c&&c<=95;if(!(f||g))return[];e=a<=23?1:2;64<=c&&c<=95?f=e===1?j[a]:l[a]:f=e===1?k[a]:m[a];if(f==null)return[];c;c>95?g=c-96:g=c-64;a={color:null,italics:!1,indent:null,underline:!1,row:f};a.underline=(g&1)===1;g<=13?a.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(g/2)]:g<=15?(a.italics=!0,a.color="white"):a.indent=Math.floor((g-16)/2)*4;return[{type:b("VideoPlayerCea608Command").PAC,data:{chNr:e,pacData:a},presentationTime:d}]}var o=(c={},c[42]=225,c[92]=233,c[94]=237,c[95]=243,c[96]=250,c[123]=231,c[124]=247,c[125]=209,c[126]=241,c[127]=9608,c[128]=174,c[129]=176,c[130]=189,c[131]=191,c[132]=8482,c[133]=162,c[134]=163,c[135]=9834,c[136]=224,c[137]=32,c[138]=232,c[139]=226,c[140]=234,c[141]=238,c[142]=244,c[143]=251,c[144]=193,c[145]=201,c[146]=211,c[147]=218,c[148]=220,c[149]=252,c[150]=8216,c[151]=161,c[152]=42,c[153]=8217,c[154]=9473,c[155]=169,c[156]=8480,c[157]=8226,c[158]=8220,c[159]=8221,c[160]=192,c[161]=194,c[162]=199,c[163]=200,c[164]=202,c[165]=203,c[166]=235,c[167]=206,c[168]=207,c[169]=239,c[170]=212,c[171]=217,c[172]=249,c[173]=219,c[174]=171,c[175]=187,c[176]=195,c[177]=227,c[178]=205,c[179]=204,c[180]=236,c[181]=210,c[182]=242,c[183]=213,c[184]=245,c[185]=123,c[186]=125,c[187]=92,c[188]=94,c[189]=95,c[190]=124,c[191]=8764,c[192]=196,c[193]=228,c[194]=214,c[195]=246,c[196]=223,c[197]=165,c[198]=164,c[199]=9475,c[200]=197,c[201]=229,c[202]=216,c[203]=248,c[204]=9487,c[205]=9491,c[206]=9495,c[207]=9499,c);function p(a){var b=a;Object.prototype.hasOwnProperty.call(o,a)&&(b=o[a]);return String.fromCharCode(b)}function q(a,c,d){__p&&__p();var e=null,f=null,g;a>=25?(e=2,g=a-8):(e=1,g=a);var h=!1;if(17<=g&&g<=19){var i;c;g===17?i=c+80:g===18?i=c+112:i=c+144;f=[i];h=!0}else 32<=a&&a<=127&&(f=c===0?[a]:[a,c]);g=[];if(f)for(var i=0;i<f.length;++i){a=f[i];a>=144&&g.push({type:b("VideoPlayerCea608Command").BACKSPACE,data:{chNr:e},presentationTime:d});c=p(a);g.push({type:b("VideoPlayerCea608Command").TEXT,data:{chNr:e,character:c,isSpecial:h},presentationTime:d})}return g}function r(a,b,c,d){__p&&__p();d=a;a=b;if(!(h(d)%2))return[];if(!(h(a)%2))return[];d&=127;a&=127;if(!(d&112)&&!(a&112))return[];b=s(d,a,c);if(b.length)return b;b=i(d,a,c);if(b.length)return b;b=n(d,a,c);if(b.length)return b;b=q(d,a,c);return b.length?b:[]}function s(a,c,d){__p&&__p();a=a;c=c;var e=(a===20||a===21||a===28||a===29)&&32<=c&&c<=47,f=(a===23||a===31)&&33<=c&&c<=35;if(!(e||f))return[];e=null;a===20||a===21||a===23?e=1:e=2;if(a===20||a===21||a===28||a===29){f=null;switch(c){case 32:f=b("VideoPlayerCea608Command").RESUME_CAPTION_LOADING;break;case 33:f=b("VideoPlayerCea608Command").BACKSPACE;break;case 34:f=b("VideoPlayerCea608Command").__DEPRECATED__ALARM_OFF;break;case 35:f=b("VideoPlayerCea608Command").__DEPRECATED__ALARM_ON;break;case 36:f=b("VideoPlayerCea608Command").DELETE_TIL_END_OF_ROW;break;case 37:f=b("VideoPlayerCea608Command").START_ROLL_UP_2;break;case 38:f=b("VideoPlayerCea608Command").START_ROLL_UP_3;break;case 39:f=b("VideoPlayerCea608Command").START_ROLL_UP_4;break;case 40:f=b("VideoPlayerCea608Command").FLASH_ON;break;case 41:f=b("VideoPlayerCea608Command").RESUME_DIRECT_CAPTIONING;break;case 42:f=b("VideoPlayerCea608Command").__DEPRECATED__TEXT_RESTART;break;case 43:f=b("VideoPlayerCea608Command").__DEPRECATED__RESUME_TEXT_DISPLAY;break;case 44:f=b("VideoPlayerCea608Command").ERASE_DISPLAY_MEMORY;break;case 45:f=b("VideoPlayerCea608Command").CARRIAGE_RETURN;break;case 46:f=b("VideoPlayerCea608Command").ERASE_NON_DISPLAY_MEMORY;break;case 47:f=b("VideoPlayerCea608Command").END_OF_CAPTION;break;default:return[]}return[{type:f,data:{chNr:e},presentationTime:d}]}else{a=c-32;return[{type:b("VideoPlayerCea608Command").TAB_OFFSET,data:{chNr:e,tabOffset:a},presentationTime:d}]}}d={extract:function(a){__p&&__p();return b("Promise").resolve().then(function(){__p&&__p();return b("CEA608ByteListExtractor").extract(a).then(function(a){__p&&__p();var b;a.every(function(a){return!isNaN(a.time)&&a.bytePairsFlat.every(function(a){return!isNaN(a)})})||g(0,18731);var c=[];a.forEach(function(a){for(var d=0;d<a.bytePairsFlat.length;d+=2){var e=r(a.bytePairsFlat[d],a.bytePairsFlat[d+1],a.time,b);c.push.apply(c,e)}});return c})})}};e.exports=d}),null);
__d("VideoPlayerCea608CaptionsSource",["requireCond","cr:1141468"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:1141468")}),null);
__d("VideoPlayerCea608CaptionsSourceImplFacebook",["VideoPlayerCea608Command","extractCEA608","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=!1,h,i=15,j=32,k=function(){__p&&__p();function a(){this.$2=0;this.$1=new Array(j);for(var a=0;a<j;++a)this.$1[a]=" "}var b=a.prototype;b.setPos=function(a){this.$2=Math.max(0,Math.min(j-1,a))};b.movePos=function(a){a=this.$2+a;this.setPos(a)};b.backspace=function(){this.movePos(-1),this.$1[this.$2]=" "};b.putCharacter=function(a){var b=this.$2;b<j&&(this.$1[b]=a,this.movePos(1))};b.clearFromPos=function(a){for(var a=a;a<j;a++)this.$1[a]=" "};b.clear=function(){this.clearFromPos(0),this.$2=0};b.clearToEndOfRow=function(){this.clearFromPos(this.$2)};b.getCharacters=function(){return this.$1};b.getPos=function(){return this.$2};return a}(),l=function(){__p&&__p();function a(){this.$2=i-1;this.$3=null;this.$1=new Array(i);for(var a=0;a<i;++a)this.$1[a]=new k()}var b=a.prototype;b.clear=function(){this.$1.forEach(function(a,b){a.clear()})};b.setPAC=function(a){var b=a.row-1;this.$3!=null&&b<this.$3-1&&(b=this.$3-1);this.$2=b;b=this.$1[this.$2];a.indent!==null&&b.setPos(a.indent)};b.putCharacter=function(a){var b=this.$1[this.$2];b.putCharacter(a)};b.movePos=function(a){var b=this.$1[this.$2];b.movePos(a)};b.setRollupSize=function(a){this.$3=a};b.rollup=function(){if(this.$3==null)return;var a=this.$2+1-this.$3;a=this.$1.splice(a,1)[0];a.clear();this.$1.splice(this.$2,0,a)};b.backspace=function(){this.$1[this.$2].backspace()};b.clearToEndOfRow=function(){this.$1[this.$2].clearToEndOfRow()};b.getRows=function(){return this.$1.slice()};b.getCurrentRowIndex=function(){return this.$2};return a}();function m(a){return a.getRows().map(function(a){return a.getCharacters().join("")})}function n(a){var b=a.getCurrentRowIndex();return"\n"+a.getRows().map(function(a,c){var d=a.getPos();return String(c+1).padStart(3," ")+" ["+a.getCharacters().join("")+"]"+(c===b?"< ":"  ")+String(d).padStart(2," ")}).join("\n")+"\n"}var o=function(){__p&&__p();function a(){}var c=a.prototype;c.handleCommand=function(a,c,d){__p&&__p();switch(a.type){case b("VideoPlayerCea608Command").TEXT:d.putCharacter(a.data.character);return!1;case b("VideoPlayerCea608Command").TAB_OFFSET:d.movePos(a.data.tabOffset);return!1;case b("VideoPlayerCea608Command").CARRIAGE_RETURN:return!1;case b("VideoPlayerCea608Command").BACKSPACE:d.backspace();return!1;case b("VideoPlayerCea608Command").DELETE_TIL_END_OF_ROW:d.clearToEndOfRow();return!1;case b("VideoPlayerCea608Command").ERASE_DISPLAY_MEMORY:c.clear();return!0;case b("VideoPlayerCea608Command").ERASE_NON_DISPLAY_MEMORY:d.clear();return!1;case b("VideoPlayerCea608Command").PAC:d.setPAC(a.data.pacData);return!1;default:return!1}};return a}(),p=function(){__p&&__p();function a(){}var c=a.prototype;c.handleCommand=function(a,c,d){__p&&__p();switch(a.type){case b("VideoPlayerCea608Command").TEXT:c.putCharacter(a.data.character);return!0;case b("VideoPlayerCea608Command").TAB_OFFSET:c.movePos(a.data.tabOffset);return!1;case b("VideoPlayerCea608Command").CARRIAGE_RETURN:return!1;case b("VideoPlayerCea608Command").BACKSPACE:c.backspace();return!0;case b("VideoPlayerCea608Command").DELETE_TIL_END_OF_ROW:c.clearToEndOfRow();return!0;case b("VideoPlayerCea608Command").ERASE_DISPLAY_MEMORY:c.clear();return!0;case b("VideoPlayerCea608Command").PAC:c.setPAC(a.data.pacData);return!1;default:return!1}};return a}(),q=function(){__p&&__p();function a(){}var c=a.prototype;c.handleCommand=function(a,b,c){return this.$1(a,b,c)};c.$1=function(a,c,d){__p&&__p();switch(a.type){case b("VideoPlayerCea608Command").TEXT:c.putCharacter(a.data.character);return!0;case b("VideoPlayerCea608Command").TAB_OFFSET:c.movePos(a.data.tabOffset);return!1;case b("VideoPlayerCea608Command").CARRIAGE_RETURN:c.rollup();return!0;case b("VideoPlayerCea608Command").BACKSPACE:c.backspace();return!0;case b("VideoPlayerCea608Command").DELETE_TIL_END_OF_ROW:c.clearToEndOfRow();return!0;case b("VideoPlayerCea608Command").ERASE_DISPLAY_MEMORY:c.clear();return!0;case b("VideoPlayerCea608Command").ERASE_NON_DISPLAY_MEMORY:d.clear();return!1;case b("VideoPlayerCea608Command").PAC:c.setPAC(a.data.pacData);return!1;default:return!1}};return a}();a=function(){__p&&__p();function a(a){__p&&__p();var b=a.onCaptionsLoaded;a=a.onCaptionsChanged;this.$1=null;this.$2=null;this.$3=[];this.$4=null;this.$5=new l();this.$6=new l();this.$7=new o();this.$8=null;this.$9=null;this.$10={changedCount:0,commandsHandledCount:0,fragmentsInsertedCount:0,fragmentsProcessedCount:0,processStartedCount:0,processedCount:0,timeUpdateHandledCount:0};this.$1=b;this.$2=a}var c=a.prototype;c.appendFragments_DEPRECATED=function(a){this.$11(a)};c.processBytes=function(a){var c=this;this.$10.processStartedCount++;return b("extractCEA608")({debugLogEnabled:g,timescale:a.timescale,videoBytes:a.videoBytes}).then(function(a){c.$10.processedCount++,c.$11(a)})};c.handleTimeUpdate=function(a){this.$12(a)};c.getStagingScreenForTestSnapshot=function(){return n(this.$6)};c.getDisplayScreenForTestSnapshot=function(){return n(this.$5)};c.getCurrentScreenRepresentation=function(){return{rows:this.$8,styles:this.$9}};c.destroy=function(){this.$1=null,this.$2=null,this.$3.length=0,this.$4=null,this.$5.clear(),this.$6.clear(),this.$8=null,this.$9=null,this.$10={changedCount:0,commandsHandledCount:0,fragmentsInsertedCount:0,fragmentsProcessedCount:0,processStartedCount:0,processedCount:0,timeUpdateHandledCount:0}};c.$11=function(a){__p&&__p();var b=this,c=this.$1;c&&(c(),this.$1=null);a.forEach(function(a){var c=a.presentationTime,d;for(d=b.$3.length;d>0;d--){var e=d===b.$3.length?Number.MAX_VALUE:b.$3[d].presentationTime,f=b.$3[d-1].presentationTime;if(c<e&&c>=f)break}b.$10.fragmentsInsertedCount++;b.$3.splice(d,0,a)})};c.$12=function(a){__p&&__p();this.$10.timeUpdateHandledCount++;if(!this.$3.length||this.$3[0].presentationTime>a)return;var c=0,d=!1;for(;c<this.$3.length;++c){var e=this.$3[c];if(e.presentationTime>a)break;this.$10.fragmentsProcessedCount++;if(this.$4!=null&&(e.type!==b("VideoPlayerCea608Command").TEXT||e.data.isSpecial===!0)&&JSON.stringify(e)===JSON.stringify(this.$4))continue;this.$4=e;e=this.$13(e);e&&(d=!0);this.$10.commandsHandledCount++}this.$3.splice(0,c);this.$14(m(this.$5),{textAlignment:this.$15(this.$7)})};c.$13=function(a){__p&&__p();switch(a.type){case b("VideoPlayerCea608Command").RESUME_CAPTION_LOADING:this.$7=new o();return!1;case b("VideoPlayerCea608Command").RESUME_DIRECT_CAPTIONING:this.$7=new p();this.$5=this.$6;this.$6=new l();return!0;case b("VideoPlayerCea608Command").END_OF_CAPTION:if(this.$7 instanceof o){var c=this.$6;this.$6=this.$5;this.$5=c;return!0}return!1;case b("VideoPlayerCea608Command").START_ROLL_UP_2:this.$5.setRollupSize(2);this.$7=new q();return!1;case b("VideoPlayerCea608Command").START_ROLL_UP_3:this.$5.setRollupSize(3);this.$7=new q();return!1;case b("VideoPlayerCea608Command").START_ROLL_UP_4:this.$5.setRollupSize(4);this.$7=new q();return!1}c=this.$7.handleCommand(a,this.$5,this.$6);return c};c.$15=function(a){if(a instanceof o)return"center";else if(a instanceof p)return"center";else if(a instanceof q)return"left";else return"center"};c.$14=function(a,b){if(this.$8==null||this.$8.length!==a.length||this.$8.some(function(b,c){return b!==a[c]})){this.$10.changedCount++;var c=this.$2;c&&c(a,b)}this.$8=a;this.$9=b};return a}();e.exports=a}),null);