if (self.CavalryLogger) { CavalryLogger.start_js(["BNuvB"]); }

__d("MercuryPagesOneClickMessageButton.react",["cx","MNCommerceCTAProcessor","MNCommercePostbackCTADataManager","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=function(){d.props.cta.title!==void 0&&d.props.cta.title!==null&&b("MNCommercePostbackCTADataManager").sendAndConfirm(d.props.cta.id,d.props.cta.title,d.props.threadID,null,null),b("MNCommerceCTAProcessor").logCTAClick(d.props.cta)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return b("React").jsx("a",{className:"_7bl6",href:"#",onClick:this.$1,children:this.props.message})};return c}(b("React").PureComponent);e.exports=a}),null);
__d("MercuryPagesGreetingContainer.react",["cx","invariant","ix","CurrentUser","Grid.react","Image.react","Link.react","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercuryPagesOneClickMessageButton.react","MessagingTag","MessengerDiscoveryEntryPoint","MessengerDiscoveryEntryPointsLoggingHelper","MessengerEnvironment","OrganicIntakeFormMutationUtils","PagesLogger","PagesLoggerEventEnum","PagesLoggerEventTargetEnum","PagesMessagingMercuryChatTabActions","PagesMessagingMercuryChatTabStore","React","prop-types","StoreAndPropBasedStateMixin","fbglyph","ifRequired","getPageIDFromThreadID"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("MercuryMessageActions").get(),k=b("Grid.react").GridItem,l=function(a){var c=function(){var c=new(b("MercuryMessageObject"))(b("CurrentUser").getID());j.send(c.constructUserGeneratedMessageObject(a.icebreakerTextForOrganicIntakeForm,"source:titan:web",a.threadID,null,null,null));b("OrganicIntakeFormMutationUtils").triggerOrganicIntakeForm(b("CurrentUser").getID(),a.pageID,"message")};return b("React").jsx(b("Link.react"),{className:"_7bl6",href:"#",onClick:c,children:a.icebreakerTextForOrganicIntakeForm})},m=function(a){__p&&__p();var c=[];b("ifRequired")("FantaAppStore",function(d){d=d.getState().tabGroup.tabs.get(b("MercuryIDs").getThreadIDFromUserID(a.pageID));c=[b("MessagingTag").ONE_CLICK_MESSAGE];d&&d.entryPoint&&d.entryPoint[0]&&Object.values(b("MessengerDiscoveryEntryPoint")).indexOf(d.entryPoint[0])!==-1&&c.push(b("MessengerDiscoveryEntryPointsLoggingHelper").getEntryPointsLoggingTagStr([d.entryPoint[0]]))});var d=function(){var d=new(b("MercuryMessageObject"))(b("CurrentUser").getID());j.send(d.constructUserGeneratedMessageObject(a.message,"source:titan:web",a.threadID,null,null,c));b("PagesLogger").log(a.pageID,b("PagesLoggerEventEnum").CLICK,b("PagesLoggerEventTargetEnum").MESSENGER_ONE_CLICK_MESSAGE_BUTTON,"www_chat_null_state",["pages_messaging_www","PagesComms","OneClick"],{message:a.messageType,position:a.position})};return b("React").jsx("a",{className:"_7bl6",href:"#",onClick:d,children:a.message})};a=b("React").createClass({displayName:"MercuryPagesGreetingContainer",propTypes:{threadID:b("prop-types").string.isRequired},mixins:[b("StoreAndPropBasedStateMixin")(b("PagesMessagingMercuryChatTabStore"))],statics:{calculateState:function(a){a=b("PagesMessagingMercuryChatTabStore").getStateByThread(a.threadID);return{shouldShowGreetingMessage:a.pagesGreetingShouldShow&&a.pagesGreetingContent&&a.pagesGreetingContent.length>0,shouldShowIcebreakers:a.icebreakerCtas&&a.icebreakerCtas.length>0||a.icebreakers&&Object.keys(a.icebreakers).length>0,greetingMessage:a.pagesGreetingContent,pageResponsiveness:a.pageResponsiveness,connectionContext:a.connectionContext,pageOnlineMessage:a.pageOnlineMessage,showOrganicIntakeForm:a.showOrganicIntakeForm,icebreakerTextForOrganicIntakeForm:a.icebreakerTextForOrganicIntakeForm}}},getInitialState:function(){return{loggedButtonImpressions:[]}},componentDidMount:function(){b("PagesMessagingMercuryChatTabActions").requestGreetingConfig(this.props.threadID);var a=b("getPageIDFromThreadID")(this.props.threadID);a!=null&&b("OrganicIntakeFormMutationUtils").maybeTriggerOrganicIntakeForm(b("CurrentUser").getID(),a)},render:function(){var a;this.state.shouldShowIcebreakers?a=this._renderIcebreakers():this.state.showOrganicIntakeForm&&(a=this._getOrganicIntakeFormIcebreaker());return b("React").jsxs("div",{children:[b("React").jsxs(b("Grid.react"),{alignv:"top",className:(b("MessengerEnvironment").messengerui?"_7bl7":"")+(b("MessengerEnvironment").messengerui?"":" _7bkq"),cols:2,spacing:"_7bkr",children:[this._renderTopRow(),this._renderSubRow()]}),a]})},_renderIcebreakers:function(){__p&&__p();var a=this,c=b("PagesMessagingMercuryChatTabStore").getStateByThread(this.props.threadID),d=c.icebreakers;c=c.icebreakerCtas;d!==void 0&&d!==null||h(0,2536);var e=b("MercuryIDs").getUserIDFromThreadID(this.props.threadID);e!==void 0&&e!==null||h(0,2537);this.state.showOrganicIntakeForm&&(d=d.slice(0,d.length-1),c!==void 0&&c!==null&&(c=c.slice(0,c.length-1)));c!==void 0&&c!==null?d=c.map(function(c){return b("React").jsx(k,{children:b("React").jsx(b("MercuryPagesOneClickMessageButton.react"),{cta:c,message:String(c.title),threadID:a.props.threadID})},c.id)}):d=d.map(function(c,d){var f=c.messageKey;a._maybeLogOneClickMessageImpression(e,f,d);return b("React").jsx(k,{children:b("React").jsx(m,{message:String(c.message),messageType:f,pageID:e,position:d,threadID:a.props.threadID})},f)});return b("React").jsxs(b("Grid.react"),{alignh:"center",className:"_7bks",cols:1,children:[this.state.showOrganicIntakeForm&&b("React").jsx(l,{icebreakerTextForOrganicIntakeForm:this.state.icebreakerTextForOrganicIntakeForm,pageID:e,threadID:this.props.threadID}),d]})},_getOrganicIntakeFormIcebreaker:function(){var a=b("MercuryIDs").getUserIDFromThreadID(this.props.threadID);a!==void 0&&a!==null||h(0,2537);return this.state.icebreakerTextForOrganicIntakeForm?b("React").jsx(b("Grid.react"),{alignh:"center",className:"_7bks",cols:1,children:b("React").jsx(l,{icebreakerTextForOrganicIntakeForm:this.state.icebreakerTextForOrganicIntakeForm,pageID:a,threadID:this.props.threadID})}):null},_renderTopRow:function(){if(this.state.pageOnlineMessage)return this._renderOnlineMessage();return this.state.pageResponsiveness?this._renderPageResponsiveness():null},_renderSubRow:function(){return this.state.shouldShowGreetingMessage?[b("React").jsx(k,{className:"_7bl8",children:b("React").jsx(b("Image.react"),{src:i("124738")})},"messenger_greeting_icon"),b("React").jsx(k,{className:"_7bl9",children:this.state.greetingMessage},"messenger_greeting_text")]:this._renderConnectionContext()},_renderOnlineMessage:function(){return[b("React").jsx(k,{className:"_7bla",children:b("React").jsx(b("Image.react"),{src:i("311943")})},"online_indicator_icon"),b("React").jsx(k,{className:"_7blb",children:this.state.pageOnlineMessage},"online_indicator_text")]},_renderPageResponsiveness:function(){return[b("React").jsx(k,{children:b("React").jsx(b("Image.react"),{src:i("124279")})},"page_responsiveness_icon"),b("React").jsx(k,{className:"_7blb",children:this.state.pageResponsiveness},"page_responsiveness_text")]},_renderConnectionContext:function(){return!this.state.connectionContext?null:[b("React").jsx(k,{className:"_7bl8",children:b("React").jsx(b("Image.react"),{src:i("124577")})},"connection_context_icon"),b("React").jsx(k,{className:"_7bl9",children:this.state.connectionContext},"connection_context_text")]},_maybeLogOneClickMessageImpression:function(a,c,d){var e=this.state.loggedButtonImpressions;if(e.indexOf(c)>=0)return;b("PagesLogger").log(a,b("PagesLoggerEventEnum").IMPRESSION,b("PagesLoggerEventTargetEnum").MESSENGER_ONE_CLICK_MESSAGE_BUTTON,"www_chat_null_state",["pages_messaging_www","PagesComms","OneClick"],{position:d,message:c});e.push(c);this.setState({loggedButtonImpressions:e})}});e.exports=a}),null);