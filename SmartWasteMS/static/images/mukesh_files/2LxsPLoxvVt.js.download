if (self.CavalryLogger) { CavalryLogger.start_js(["FAq7+"]); }

__d("VideoChannelProgressCircle.react",["cx","React","ReactDOM","Style","prop-types"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=null,c.$2=0,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){this.drawProgressCircle(this.props)};d.componentWillUnmount=function(){clearInterval(this.$1)};d.UNSAFE_componentWillReceiveProps=function(a){(a.makeProgress!==this.props.makeProgress||a.timeoutSec!==this.props.timeoutSec)&&this.drawProgressCircle(a)};d.drawProgressCircle=function(a){var c=this,d=b("ReactDOM").findDOMNode(this.refs.progressCircle),e=this.$2,f=e/100;b("Style").set(d,"stroke-dashoffset",e+"px");clearInterval(this.$1);a.makeProgress&&(this.$1=setInterval(function(){e-=f,b("Style").set(d,"stroke-dashoffset",e+"px"),e<=0&&(clearInterval(c.$1),b("Style").set(d,"stroke-dashoffset","0px"),a.onProgressDone&&a.onProgressDone())},a.timeoutSec*10))};d.render=function(){var a=this.props.watchAndScroll?34:80,c=this.props.watchAndScroll?2:4;a=a/2;var d=a-c/2;this.$2=d*2*Math.PI;return b("React").jsxs("div",{children:[b("React").jsxs("svg",{className:"_20_8",children:[b("React").jsx("circle",{cx:a,cy:a,r:d,stroke:"#ffffff",strokeWidth:c,strokeDasharray:this.$2,fill:"transparent"}),b("React").jsx("circle",{ref:"progressCircle",cx:a,cy:a,r:d,stroke:"#5890ff",strokeWidth:c,strokeDasharray:this.$2,fill:"transparent"})]}),this.props.children]})};return c}(b("React").PureComponent);a.propTypes={children:(c=b("prop-types")).element,makeProgress:c.bool.isRequired,onProgressDone:c.func,timeoutSec:c.number.isRequired,watchAndScroll:c.bool};e.exports=a}),null);
__d("VideoChannelReplayImage.react",["cx","Image.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").jsx(b("Image.react"),{onClick:this.props.onClick,className:"_4nxy"+(this.props.size==="small"?" _4nxz":""),src:"/images/video/channel_view/replay.svg"})};return c}(b("React").Component);a.defaultProps={size:"normal"};e.exports=a}),null);
__d("XVideoChannelViewAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/channel/view/async/{id}/",{id:{type:"String",required:!0},original_video_id:{type:"String",required:!0},cursor:{type:"String"},story_count:{type:"Int",defaultValue:3},caller:{type:"Enum",defaultValue:"channel_view_from_unknown",enumType:1}})}),null);
__d("XVideoChannelViewStoryAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/channel/view/story/async/{root_video_id}/",{root_video_id:{type:"String",required:!0},video_ids:{type:"StringVector",defaultValue:[]},use_video_placeholder:{type:"Bool",defaultValue:!1},setup_interactions:{type:"Bool",defaultValue:!1},is_first_story:{type:"Bool",defaultValue:!1},feed_tracking_data:{type:"StringVector",defaultValue:[]},caller:{type:"Enum",defaultValue:"channel_view_from_unknown",enumType:1},channel_id:{type:"String"},ad_impression_token:{type:"String"},fetch_channel_pivots:{type:"Bool",defaultValue:!1}})}),null);
__d("VideoChannelStoryFetcher",["requireCond","AsyncRequest","HTML","cr:1137960","XVideoChannelViewAsyncController","XVideoChannelViewStoryAsyncController"],(function(a,b,c,d,e,f){__p&&__p();var g=(b("cr:1137960")==null?void 0:b("cr:1137960").channelPivots)||!1;a=function(){"use strict";__p&&__p();function a(a,b,c,d,e,f,g){__p&&__p();this.$7=a;this.$8=b;this.$4=c;this.$10=0;this.$2=null;this.$3=!0;this.$5=[];this.$6=[];this.$9={};if(e){this.$5=e.videoIDs;this.$6=e.feedTrackingData;this.$2=e.cursorInfo.cursor;this.$3=e.cursorInfo.hasNextPage;a=this.$5.indexOf(this.$7);this.$9.start=a;this.$9.end=a+1}if(f){this.$5=f;this.$3=!!g;b=this.$5.indexOf(this.$7);this.$9.start=b;this.$9.end=b+1}this.$11=d;this.$12=[];this.$13=[]}var c=a.prototype;c.reset=function(a,b){this.$7=a,this.$8=b,this.$10=0,this.$2=null,this.$3=!0,this.$5=[],this.$6=[],this.$9={},this.$12=[],this.$13=[]};c.abandonRequest=function(){this.$1&&this.$1.abandon()};c.hasNext=function(){var a=this.$5.length-this.$9.end>0;return this.$3||a};c.$14=function(a,b,c){var d={};d.event=a;d.request_status=b;d.perf_time_ms=Date.now()-c;g&&(d.video_channel_id=this.$8)};c.fetchFirstStory=function(a,c,d){__p&&__p();var e=this;if(c===null&&this.$5.length!==0){var f=this.$5.indexOf(this.$7);c=this.$6[f]}f=b("XVideoChannelViewStoryAsyncController").getURIBuilder().setEnum("caller",this.$4).setStringVector("video_ids",[this.$7]).setString("root_video_id",this.$7).setBool("is_first_story",!0).setBool("use_video_placeholder",a).setBool("setup_interactions",d).setString("channel_id",this.$8).setString("ad_impression_token",this.$11);c&&f.setStringVector("feed_tracking_data",[JSON.stringify(c)]);var h=Date.now();a=new(b("AsyncRequest"))(f.getURI()).setAllowCrossPageTransition(!0).setHandler(function(){__p&&__p();e.$14("fetch_first_story_success","succeeded",h);e.$15();if(g){var a=Date.now(),d=b("XVideoChannelViewStoryAsyncController").getURIBuilder().setEnum("caller",e.$4).setStringVector("video_ids",[e.$7]).setString("root_video_id",e.$7).setString("channel_id",e.$8).setBool("fetch_channel_pivots",!0);c&&d.setStringVector("feed_tracking_data",[JSON.stringify(c)]);d=new(b("AsyncRequest"))(d.getURI()).setAllowCrossPageTransition(!0).setHandler(function(){e.$14("fetch_channel_pivots_success","succeeded",a),e.$15()}).setErrorHandler(function(){e.$14("fetch_channel_pivots_success","failed",a),e.$15()}).setAbortHandler(function(){e.$14("fetch_channel_pivots_success","aborted",a),e.$15()});e.$1=d;e.$10=Date.now();d.send()}}).setErrorHandler(function(){e.$14("fetch_first_story_success","failed",h),e.$15()}).setAbortHandler(function(){e.$14("fetch_first_story_success","aborted",h),e.$15()});this.$1=a;this.$10=Date.now();a.send()};c.getPreloadedData=function(){return{stories:this.$12,thumbnails:this.$13}};c.$16=function(a,c){__p&&__p();var d=this;if(!this.$8)return;a=b("XVideoChannelViewAsyncController").getURIBuilder().setString("id",this.$8).setEnum("caller",this.$4).setString("original_video_id",this.$7).setInt("story_count",a);this.$2&&a.setString("cursor",this.$2.toString());var e=Date.now();a=a.getURI();a=new(b("AsyncRequest"))(a).setAllowCrossPageTransition(!0).setHandler(function(a){d.$14("fetch_stories_from_entquery","succeeded",e),d.$2=a.getPayload().cursor,d.$3=a.getPayload().hasNextPage,d.$15(),d.$17(a,function(a,b){d.$12=[].concat(d.$12,a);d.$13=[].concat(d.$13,b);return c(a,b)})}).setErrorHandler(function(){d.$14("fetch_stories_from_entquery","failed",e),d.$15()}).setAbortHandler(function(){d.$14("fetch_stories_from_entquery","aborted",e),d.$15()});this.$1=a;a.send()};c.$18=function(a,c,d){__p&&__p();var e=this,f=this.$9.end,g=this.$5.length-f,h=f+Math.min(g,a);if(g>0){var i=this.$5.slice(f,h);f=this.$6.slice(f,h).map(function(a){return JSON.stringify(a)});i=b("XVideoChannelViewStoryAsyncController").getURIBuilder().setEnum("caller",this.$4).setString("channel_id",this.$8).setString("root_video_id",this.$7).setStringVector("video_ids",i).setStringVector("feed_tracking_data",f);var j=Date.now();this.$1=new(b("AsyncRequest"))(i.getURI()).setAllowCrossPageTransition(!0).setErrorHandler(function(){e.$14("fetch_stories_forward","failed",j),e.$15()}).setAbortHandler(function(){e.$14("fetch_stories_forward","aborted",j),e.$15()}).setHandler(function(a){e.$14("fetch_stories_forward","succeeded",j),e.$9.end=h,e.$15(),e.$17(a,function(a,b){e.$12=[].concat(e.$12,a);e.$13=[].concat(e.$13,b);return c(a,b)})});this.$1.send();d&&d(g)}else this.$3&&(this.$16(a,c),d&&d(a))};c.$19=function(a,c,d){__p&&__p();var e=this,f=this.$9.start;if(f>0){var g=Math.max(f-a,0);a=this.$5.slice(g,f);var h=this.$6.slice(g,f).map(function(a){return JSON.stringify(a)});a=b("XVideoChannelViewStoryAsyncController").getURIBuilder().setEnum("caller",this.$4).setString("channel_id",this.$8).setString("root_video_id",this.$7).setStringVector("video_ids",a).setStringVector("feed_tracking_data",h);var i=Date.now();this.$1=new(b("AsyncRequest"))(a.getURI()).setAllowCrossPageTransition(!0).setErrorHandler(function(){e.$14("fetch_stories_backward","failed",i),e.$15()}).setAbortHandler(function(){e.$14("fetch_stories_backward","aborted",i),e.$15()}).setHandler(function(a){e.$14("fetch_stories_backward","succeeded",i),e.$9.start=g,e.$15(),e.$17(a,c)});this.$1.send();d&&d(f-g)}};c.fetchStories=function(a,c,d){var e=(b("cr:1137960")==null?void 0:b("cr:1137960").defaultStoriesToLoad)||3;if(this.$1)return;a?this.$18(e,c,d):this.$19(e,c,d)};c.$17=function(a,c){a=a.getPayload();var d=b("HTML").replaceJSONWrapper(a.stories).getNodes();a=a.thumbnails.map(function(a){return b("HTML").replaceJSONWrapper(a).getRootNode()});c(d,a)};c.$15=function(){this.$1=null};return a}();e.exports=a}),null);
__d("XVideoWnsUpNextAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/wns/upnext/async/{video_id}/",{video_id:{type:"FBID",required:!0},viewed_videos:{type:"FBIDSet"}})}),null);
__d("VideoWatchAndScrollDrawer.react",["csx","cx","fbt","AsyncRequest","DOM","DOMContainer.react","FBLoadShimmer.react","React","XVideoWnsUpNextAsyncController","cxMargin"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={fetching:!0,upNext:null},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){this.props.videoID&&this.$2(this.props.videoID)};d.componentWillUnmount=function(){this.$1&&this.$1.abort()};d.$2=function(a){__p&&__p();var c=this;a=b("XVideoWnsUpNextAsyncController").getURIBuilder().setFBID("video_id",a).setFBIDSet("viewed_videos",this.props.viewedVideos);this.$1=new(b("AsyncRequest"))(a.getURI());this.$1.setHandler(function(a){a=a.getPayload();var d=a.upNextUnit&&a.upNextUnit.markup;if(d){d=b("DOM").create("div",{},d);var e=b("DOM").scry(d,"._3iqr");e.length&&(c.setState({upNext:d}),c.props.onLoadUpNext(d,a.canAutoplay))}c.setState({fetching:!1})}).send()};d.render=function(){var a=null;if(this.state.upNext)a=b("React").jsx(b("DOMContainer.react"),{children:this.state.upNext});else if(this.state.fetching){var c,d;a=(c=b("React")).jsxs("div",{className:"_2685",children:[c.jsx(d=b("FBLoadShimmer.react"),{height:70,width:124}),c.jsxs("div",{className:"_63-r",children:[c.jsx(d,{height:14,width:140,className:"_3-94"}),c.jsx(d,{height:14,width:140,className:"_3-94"}),c.jsx(d,{height:14,width:70,className:"_3-94"}),c.jsx(d,{height:14,width:70})]})]})}else return null;return b("React").jsxs("div",{className:"_3rq1 _60a7 _2tyk",children:[b("React").jsx("div",{className:"_3652",children:b("React").jsx("div",{className:"_3653",children:i._("Up Next")})}),a]})};return c}(b("React").Component);e.exports=a}),null);
__d("VideoWatchAndScrollEndScreen.react",["ix","cx","fbt","Image.react","PopoverMenu.react","React","ReactXUIMenu","ShimButton.react","TooltipData","VideoChannelProgressCircle.react","VideoChannelReplayImage.react","VideoPlayerExperiments","fbglyph","prop-types"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=b("VideoPlayerExperiments").showWNSClose,k=function(a){a=a.onClose;return b("React").jsx(b("ShimButton.react"),{className:"_3r7h",onClick:a,children:b("React").jsx(b("Image.react"),{src:g("114710")})})},l=function(a){a=a.onCollapse;return b("React").jsx("div",babelHelpers["extends"]({className:"_1dtq",onClick:a,role:"button",tabIndex:"1"},b("TooltipData").propsFor(i._("Collapse Video")),{children:b("React").jsx(b("Image.react"),{src:g("115705")})}))},m=function(a){var c=a.onClose,d=(a=b("React")).jsx(b("ReactXUIMenu"),{onItemClick:function(a,b){a=b.item;a.getValue()==="close"&&c()},children:a.jsx(b("ReactXUIMenu").Item,{value:"close",children:"Close"})});return a.jsx(b("PopoverMenu.react"),{className:"_ivg",menu:d,children:a.jsx("a",{href:"#",children:a.jsx(b("Image.react"),{src:g("114186")})})})};a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").jsxs("div",{className:"_5qdn _2se8"+(this.props.fadeOut?" _2gud":"")+" _1s-2",children:[b("React").jsx("div",{className:"_1szz _2se8",children:b("React").jsx("div",{className:"_1szy _ww8",onClick:this.props.onReplay,role:"presentation",children:b("React").jsx(b("VideoChannelProgressCircle.react"),{makeProgress:this.props.makeProgress,timeoutSec:this.props.endScreenDuration,watchAndScroll:!0,children:b("React").jsx(b("VideoChannelReplayImage.react"),{size:"small"})})})}),b("React").jsxs("div",{className:"_ivh",children:[j?null:b("React").jsx(m,{onClose:this.props.onClose}),b("React").jsx(l,{onCollapse:this.props.onCollapse}),j?b("React").jsx(k,{onClose:this.props.onClose}):null]})]})};return c}(b("React").Component);a.propTypes={endScreenDuration:(c=b("prop-types")).number.isRequired,fadeOut:c.bool,makeProgress:c.bool.isRequired,onReplay:c.func.isRequired,onClose:c.func.isRequired};e.exports=a}),null);
__d("VideoWatchAndScrollContainer.react",["csx","cx","Arbiter","CSS","DOM","DOMContainer.react","DOMDimensions","Event","Locale","Parent","React","ReactCSSTransitionGroup","Rect","SubscriptionsHandler","VideoChannelProgressCircle.react","VideoChannelReplayImage.react","VideoPlayerExperiments","VideoWatchAndScrollDrawer.react","VideoWatchAndScrollEndScreen.react","cancelAnimationFrame","clearTimeout","getViewportDimensions","prop-types","requestAnimationFrame","setTimeoutAcrossTransitions","shallowCompare","shouldWNSRenderToRHC","throttle"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=10,j=230,k=476,l=300,m=2e3,n=b("VideoPlayerExperiments").endScreenDuration,o=Object.freeze({NW:"nw",NE:"ne",SE:"se",SW:"sw"});a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b,c){b=a.call(this,b,c)||this;b.state=b.$3(b.props);return b}var d=c.prototype;d.$3=function(a){a=this.$4();var b=this.$5(this.props.initialPosition,a);return{channelVideoElements:[this.props.initialVideoElement],containerBoundingBox:a,dragging:!1,draggingStartHeight:0,draggingStartLeft:0,draggingStartMousePositionX:0,draggingStartMousePositionY:0,draggingStartTop:0,draggingStartWidth:0,endScreenFadeOut:!1,endScreenShown:!1,fadeOut:!1,fadeOutPlaceholder:null,hasDrawer:!1,height:b.height,left:b.left,playbackFinished:!1,resizeDirection:null,showDrawer:!1,timeUntilNext:0,top:b.top,width:b.width,videoIndex:0}};d.shouldComponentUpdate=function(a,c){return!this.state.fadeOut&&b("shallowCompare")(this,a,c)};d.componentDidUpdate=function(a,c){__p&&__p();var d=this;if(!c)return;!c.dragging&&this.state.dragging?(this.documentSubscriptions=new(b("SubscriptionsHandler"))(),this.documentSubscriptions.addSubscriptions(b("Event").listen(document,"mousemove",this.$6.bind(this)),b("Event").listen(document,"mouseup",this.$7.bind(this)))):c.dragging&&!this.state.dragging&&this.documentSubscriptions.release();c.playbackFinished!==this.state.playbackFinished&&this.state.playbackFinished&&this.state.timeUntilNext&&(b("clearTimeout")(this.$2),this.$8(),this.$2=b("setTimeoutAcrossTransitions")(function(){d.props.onPlayNext()},this.state.timeUntilNext*1e3));var e=["._23if","._23ig","._452w","._2i7a"],f=c.channelVideoElements||[];this.state.channelVideoElements.forEach(function(a){if(f.indexOf(a)!==-1)return;e.forEach(function(c){c=b("DOM").scry(a,c);c=c[0];c&&b("CSS").hide(c)});var c=b("DOM").scry(a,"._3pay");c=c[0];c&&(b("CSS").removeClass(c,"_3pay"),b("CSS").addClass(c,"_2337"))})};d.componentDidMount=function(){this.movementListeners=new(b("SubscriptionsHandler"))(),this.movementListeners.addSubscriptions(b("Event").listen(window,"resize",b("throttle")(this.$9.bind(this),100)),b("Arbiter").subscribe("sidebar/visibility",b("throttle")(this.$9.bind(this),100)))};d.componentWillUnmount=function(){this.documentSubscriptions&&this.documentSubscriptions.release(),this.movementListeners&&this.movementListeners.release(),this.$1&&b("clearTimeout")(this.$1),this.$2&&b("clearTimeout")(this.$2)};d.getFadeOutStatus=function(){return this.state.fadeOut};d.getChannelVideoElements=function(){return this.state.channelVideoElements};d.$9=function(){var a=this.$4(),b=this.$5({height:this.state.height,left:this.state.left,top:this.state.top,width:this.state.width},a);this.setState({containerBoundingBox:a,height:b.height,left:b.left,top:b.top,width:b.width})};d.$10=function(a,b){this.$11(b,a)};d.$12=function(a){if(b("Parent").bySelector(a.target,"._5-32")||!b("Parent").bySelector(a.target,"._3t-6"))return;this.$11(a,null)};d.$13=function(a){return a.button!==0||b("Parent").bySelector(a.target,"._3t-6")||b("Parent").bySelector(a.target,"._2se8")};d.$14=function(a){if(this.$13(a))return;this.props.onClick&&this.props.onClick()};d.$11=function(a,c){var d=a.button,e=a.target;if(d!==0)return;if(b("Parent").bySelector(e,"._360f"))return;this.props.onGrab();this.setState({containerBoundingBox:this.$4(),dragging:!0,draggingStartHeight:this.state.height,draggingStartLeft:this.state.left,draggingStartMousePositionX:a.screenX,draggingStartMousePositionY:a.screenY,draggingStartTop:this.state.top,draggingStartWidth:this.state.width,resizeDirection:c});a.preventDefault()};d.$4=function(){var a=0,c=b("DOM").scry(document.body,".fbChatSidebar");c.length===1&&(a=b("DOMDimensions").getElementDimensions(c[0]).width);c=b("getViewportDimensions").withoutScrollbars();var d=43+i,e=c.height-i,f=i;c=c.width-i;b("Locale").isRTL()?f+=a:c-=a;return new(b("Rect"))(d,c,e,f)};d.$5=function(a,c){a=new(b("Rect"))(a.top,a.left+a.width,a.top+a.height,a.left);a=a.boundWithin(c);return{height:a.h(),left:a.getLeft(),top:a.getTop(),width:a.w()}};d.$15=function(a,b,c){__p&&__p();var d=a.top,e=b.getTop();d=e-d;d>0&&((c===o.NE||c===o.NW)&&(a.height-=d),a.top=e);d=a.left;e=b.getLeft();d=e-d;d>0&&((c===o.NW||c===o.SW)&&(a.width-=d),a.left=e);c=a.top+a.height;d=b.getTop()+b.h();e=c-d;e>0&&(a.height=d-a.top);c=a.left+a.width;e=b.getLeft()+b.w();d=c-e;d>0&&(a.width=e-a.left)};d.$16=function(a,b,c){a.width<j&&((c===o.NW||c===o.SW)&&(a.left-=j-a.width),a.width=j),a.height<j&&((c===o.NE||c===o.NW)&&(a.top-=j-a.height),a.height=j)};d.$17=function(a,b,c){a.width>k&&((c===o.NW||c===o.SW)&&(a.left+=a.width-k),a.width=k),a.height>k&&((c===o.NE||c===o.NW)&&(a.top+=a.height-k),a.height=k)};d.$18=function(a,b,c){__p&&__p();var d=a.width/a.height;b=b.width/b.height;if(d>b){var e=a.height*b,f=a.height;e<j&&(f*=j/e,e=j,(c===o.NE||c===o.NW)&&(a.top+=a.height-f));(c===o.NW||c===o.SW)&&(a.left+=a.width-e);a.width=e;a.height=f}else if(d<b){e=a.width/b;(c===o.NE||c===o.NW)&&(a.top+=a.height-e);a.height=e}};d.$19=function(a,b,c,d){this.$15(a,c,d);this.$16(a,b,d);this.$17(a,b,d);this.$18(a,b,d);return{height:a.height,left:a.left,top:a.top,width:a.width}};d.$6=function(a){b("cancelAnimationFrame")(this.dragUpdateRequestAnimationFrameID),this.dragUpdateRequestAnimationFrameID=b("requestAnimationFrame")(this.$20.bind(this,a))};d.$21=function(a){(a.height!==this.state.height||a.width!==this.state.width)&&this.props.onInitialPositionUpdate(a)};d.$20=function(a){__p&&__p();if(!this.state.dragging)return;var b=a.screenX-this.state.draggingStartMousePositionX,c=a.screenY-this.state.draggingStartMousePositionY,d=this.state.resizeDirection,e;if(!d)e=this.$5({height:this.state.draggingStartHeight,left:this.state.draggingStartLeft+b,top:this.state.draggingStartTop+c,width:this.state.draggingStartWidth},this.state.containerBoundingBox),this.$21(e),this.setState({height:e.height,left:e.left,top:e.top,width:e.width});else{var f=this.state.draggingStartHeight,g=this.state.draggingStartLeft,h=this.state.draggingStartTop,i=this.state.draggingStartWidth;(d===o.NE||d===o.SE)&&(i+=b);(d===o.NW||d===o.SW)&&(g+=b,i-=b);(d===o.SE||d===o.SW)&&(f+=c);(d===o.NE||d===o.NW)&&(h+=c,f-=c);e=this.$19({height:f,left:g,top:h,width:i},{height:this.state.draggingStartHeight,left:this.state.draggingStartLeft,top:this.state.draggingStartTop,width:this.state.draggingStartWidth},this.state.containerBoundingBox,d);this.$21(e);this.setState({height:e.height,left:e.left,top:e.top,width:e.width})}a.preventDefault()};d.$7=function(a){b("cancelAnimationFrame")(this.dragUpdateRequestAnimationFrameID),this.props.onDrop(),this.setState({dragging:!1,draggingStartHeight:0,draggingStartLeft:0,draggingStartMousePositionX:0,draggingStartMousePositionY:0,draggingStartTop:0,draggingStartWidth:0,resizeDirection:null}),a.preventDefault()};d.$22=function(){this.$1&&(b("clearTimeout")(this.$1),this.$1=null),this.setState({showDrawer:!0})};d.$23=function(){this.state.showDrawer&&this.$8()};d.$24=function(){b("clearTimeout")(this.$2),this.setState({playbackFinished:!1}),this.props.onReplay()};d.$8=function(){var a=this;this.$1?b("clearTimeout")(this.$1):this.setState({showDrawer:!0});this.$1=b("setTimeoutAcrossTransitions")(function(){a.setState({showDrawer:!1}),a.$1=null},m)};d.$25=function(a,c){if(a>this.state.channelVideoElements.length)return null;a=this.state.channelVideoElements[a];return!a?null:b("React").jsx("div",{className:"_2yq3"+(c==="left"?" _2yq4":"")+(c==="center"?" _2yq5":"")+(c==="right"?" _2yq6":""),children:b("React").jsx(b("DOMContainer.react"),{children:a})},a.id)};d.$26=function(){return b("shouldWNSRenderToRHC")()?[]:[b("React").jsx("div",{className:"_52ua",onMouseDown:this.$10.bind(this,o.NW)},o.NW),b("React").jsx("div",{className:"_52uc",onMouseDown:this.$10.bind(this,o.NE)},o.NE),b("React").jsx("div",{className:"_52ui",onMouseDown:this.$10.bind(this,o.SE)},o.SE),b("React").jsx("div",{className:"_52uj",onMouseDown:this.$10.bind(this,o.SW)},o.SW)]};d.getWidth=function(){return this.state.width};d.onLoadUpNext=function(a,b){this.props.onLoadUpNext(a,b),this.setState({hasDrawer:!0})};d.canPlayAnotherVideo=function(){var a=this.state.channelVideoElements;return this.state.videoIndex<a.length-1};d.render=function(){__p&&__p();var a=this,c=null;this.props.isDrawerEnabled||(c={height:Math.round(this.state.height)+"px",left:this.state.left+"px",top:this.state.top+"px",width:Math.round(this.state.width)+"px"});var d=this.state.channelVideoElements,e=d[this.state.videoIndex];e&&(b("CSS").addClass(e,"_1kfp"),b("CSS").conditionClass(e,"_1blk",this.state.width<l));this.state.endScreenShown&&b("React").jsx(b("VideoWatchAndScrollEndScreen.react"),{endScreenDuration:n/1e3,fadeOut:this.state.endScreenFadeOut,makeProgress:this.canPlayAnotherVideo(),onReplay:this.props.onReplay,onClose:function(){b("clearTimeout")(a.$2),a.$2=null,a.props.onClose()},onCollapse:this.props.onCollapse});e=null;this.state.fadeOutPlaceholder?e=b("React").jsx(b("DOMContainer.react"),{children:this.state.fadeOutPlaceholder}):e=b("React").jsx("ul",{className:"_2yq7",children:d.map(function(c,d){(d>a.state.videoIndex+1||d<a.state.videoIndex-1)&&b("CSS").removeClass(c,"_1kfp");return d<=a.state.videoIndex+1?null:b("React").jsx("li",{children:b("React").jsx(b("DOMContainer.react"),{children:c})},c.id)})});d=null;this.state.playbackFinished&&(d=b("React").jsx("div",{role:"presentation",onClick:this.$24.bind(this),className:"_1szy _ww8",children:b("React").jsx(b("VideoChannelProgressCircle.react"),{makeProgress:!!this.state.timeUntilNext,timeoutSec:this.state.timeUntilNext,watchAndScroll:!0,children:b("React").jsx(b("VideoChannelReplayImage.react"),{size:"small"})})}));var f=null;this.props.isDrawerEnabled&&(f=b("React").jsx(b("VideoWatchAndScrollDrawer.react"),{videoID:this.props.videoID,viewedVideos:this.props.viewedVideos,onLoadUpNext:this.onLoadUpNext.bind(this)}));return b("React").jsx(b("ReactCSSTransitionGroup"),{transitionAppear:!0,transitionAppearTimeout:500,transitionEnter:!1,transitionLeave:!1,transitionName:{appear:"_tie",appearActive:"_tik"},children:b("React").jsxs("div",{className:"_360g"+(this.state.showDrawer?" _hzi":"")+(this.state.fadeOut?" _473b":"")+(this.state.hasDrawer?" _60a6":"")+(this.props.isLiveVideo()?" _29mh":""),onMouseLeave:this.$23.bind(this),onMouseMove:this.$22.bind(this),style:c,children:[b("React").jsxs("div",{className:"_52u8",onClick:this.$14.bind(this),onMouseDown:this.$12.bind(this),role:"presentation",children:[b("React").jsxs("div",{className:"_hzj",children:[this.$25(this.state.videoIndex-1,"left"),this.$25(this.state.videoIndex,"center"),this.$25(this.state.videoIndex+1,"right"),d]}),f]}),this.$26(),e]})})};return c}(b("React").Component);a.propTypes={initialPosition:(c=b("prop-types")).object.isRequired,initialVideoElement:c.instanceOf(HTMLElement).isRequired,onChannelNavigation:c.func.isRequired,onClick:c.func.isRequired,onClose:c.func.isRequired,onDrop:c.func.isRequired,onGrab:c.func.isRequired,onInitialPositionUpdate:c.func.isRequired,onReplay:c.func.isRequired};e.exports=a}),null);
__d("XVideoWNSSurveyController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/wns_survey/",{__asyncDialog:{type:"Int"}})}),null);
__d("VideoWatchAndScrollController",["csx","cx","invariant","Arbiter","AsyncRequest","CSS","DOM","DOMDimensions","Event","EventListener","LiveRHCUtils","Locale","React","ReactDOM","SubscriptionsHandler","Tahoe","VideoAutoplayControllerX","VideoChannelStoryFetcher","VideoFrameBuffer","VideoPlayerExperiments","VideoPlayerShakaGlobalConfig","VideoPlayerVolumeSettings","VideoWatchAndScrollContainer.react","VideoWatchAndScrollVariables","ViewportBounds","XVideoWNSSurveyController","cancelAnimationFrame","clearTimeout","destroyOnUnload","getViewportDimensions","ifRequired","setTimeoutAcrossTransitions","shouldWNSRenderToRHC","throttle"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=158,k=280,l=10,m=42,n=m+l,o=476,p=230,q=["autoplay_initiated","page_visibility_initiated"],r=750,s=308,t=3,u=null,v=b("VideoPlayerExperiments").persistentWNSEnabled;function w(){return Math.max(b("getViewportDimensions")().height,400)-m-80}a=function(){"use strict";__p&&__p();function a(a,c,d,e){__p&&__p();var f=this;this.$30=new(b("SubscriptionsHandler"))();this.$31=new(b("SubscriptionsHandler"))();this.$1=!1;this.$2=null;this.$3=null;this.$4=!1;this.$34=d;this.$37=!1;this.$29=!1;this.$47=e;this.$48=e;this.$33=new(b("VideoChannelStoryFetcher"))(c,a,this.$34,null);this.$35=[];this.$36=0;this.$38=[];this.$39=[];this.$5=j;this.$6=k;this.$10=window.document.getElementById("leftCol");this.$11=window.document.getElementById("rightCol");this.$12=window.document.getElementById("pagelet_bluebar");this.$43={};this.$46=null;this.$52();(d=this.$30).addSubscriptions.apply(d,this.$53());v||b("destroyOnUnload")(function(){f.$54(),f.$4&&f.$55(),f.$30&&f.$30.release(),f===u&&(u=null)})}var c=a.prototype;c.$53=function(){__p&&__p();var a=this,c=[];c.push(b("Arbiter").subscribe("VideoChannelView/opened",function(b,c){a.$4&&(!c.controller||a.$16!==c.controller)&&a.$55()}));c.push(b("Arbiter").subscribe("fbVideoWatchAndScroll/closeWNS",function(){if(!a.$4)return;var c=a.$16,d=c.getOption("CommercialBreakVideoAdOverlay","videoController");d&&(c=d);c.logEvent("watch_and_scroll_exited");a.$56();d=b("XVideoWNSSurveyController").getURIBuilder().getURI();c=new(b("AsyncRequest"))().setURI(d);c.send()}));if(b("VideoPlayerExperiments").rhcWNSEnabled){c.push(b("Arbiter").subscribe("RHCVideoWNSController/collapseStart",function(){var c=a.$14;if(!c||!b("shouldWNSRenderToRHC")())return;c.setState({endScreenFadeOut:!0,endScreenShown:!1})}),b("Arbiter").subscribe("RHCVideoWNSController/collapseEnd",function(){var c=a.$14;if(!c||!b("shouldWNSRenderToRHC")())return;a.pauseActiveVideo("user_initiated");c.setState({endScreenFadeOut:!1})}),b("Arbiter").subscribe("RHCVideoWNSController/expandStart",function(){var c=a.$14;if(!c||!a.isActiveVideoDonePlaying()||!b("shouldWNSRenderToRHC")())return;c.setState({endScreenShown:!0})}));if(v){var d=function(){var b=a.$16.getVideoNode();b instanceof HTMLVideoElement||i(0,1208);b.currentTime=b.currentTime};c.push(b("Arbiter").subscribe("RHCVideoWNSController/eject",function(c,e){if(!b("shouldWNSRenderToRHC")())return;a.$2=e;b("DOM").appendContent(document.body,e);b("VideoPlayerShakaGlobalConfig").getBool("timeouts_persist_on_page_transition",!0)||d();a.$16.isState("playing")&&a.playActiveVideo("user_initiated")}),b("Arbiter").subscribe("RHCVideoWNSController/dock",function(){if(!b("shouldWNSRenderToRHC")())return;b("VideoPlayerShakaGlobalConfig").getBool("timeouts_persist_on_page_transition",!0)||d();a.$16.isState("playing")&&a.playActiveVideo("user_initiated")}),b("Event").listen(window,"resize",b("throttle")(function(){if(!b("shouldWNSRenderToRHC")())return;a.$57()})),b("Arbiter").subscribe("RHCVideoWNSController/mount",function(){a.$57()}))}}return c};c.$57=function(){__p&&__p();var a=this.$14;if(!a||this.$37)return;var c=this.$16.getVideoNode();c=this.$58(c);this.$16.removeOffsetStylings();this.$16.setDimensions(c.width,c.height);a.setState({width:c.width,height:c.height});this.$46=c;b("Arbiter").inform("VideoWatchAndScrollController/resize")};c.isActiveVideoDonePlaying=function(){var a=this.$16.getState();return a==="finished"};a.isActiveVideoDonePlaying=function(){return u?u.isActiveVideoDonePlaying():!1};c.$59=function(a,c,d){__p&&__p();var e=this;a||i(0,3963);c.length||i(0,3964);this.$47=!0;this.$37=!1;this.$31=new(b("SubscriptionsHandler"))();this.$36=d;this.$33=a;this.$38=a.getPreloadedData().thumbnails||[];this.$39=[];this.$35=c.slice(0);this.$35.forEach(function(a){e.$60(a),e.$61(a),a.updateSource("watch_scroll")});d=this.$35.shift();this.$62(d,"user_initiated")};c.$63=function(a,b,c,d,e){var f=this;this.$9=e;this.$46=this.$58(e.videoRootNode);this.$59(a,b,c);this.$14&&this.$14.setState({channelVideoElements:d},function(){f.$64()});this.$9=null};a.registerVideoController=function(b,c,d,e){__p&&__p();u==null&&(u=new a(b.getVideoChannelID(),b.getVideoID(),c,e));u.$30.addSubscriptions(b.addListener("enterWatchAndScroll",function(){u&&u.$65(b)}),b.addListener("crossfadeWatchAndScroll",function(){if(u){u.$66();var a=b.getVideoNode();u.$46=u.$58(a);u.$62(b,"user_initiated",!1,!0);b.unmute()}}),b.addListener("exitWatchAndScroll",function(){u&&u.$4&&u.$55()}),b.addListener("VideoChannelController/enterChannel",function(){u&&(u.$37=!0)}),b.addListener("VideoChannelController/exitChannel",function(){u&&(u.$37=!1)}));c==="wns"&&u.$35.push(b);if(!d)return;e=["beginPlayback","changeVolume","muteVideo","toggleFullscreen","unmuteVideo","VideoChannelController/enterChannel"];e.forEach(function(a){u&&u.$30.addSubscriptions(b.addListener(a,function(c){u&&u.$67(b,a,c)}))})};a.isActive=function(){return!u?!1:u.$4&&!u.$37};a.updateSlidingCalculations=function(){if(!u)return;u.$19&&u.$68(u.$19)};a.registerChannelVideoController=function(a){if(!u)return;a.updateSource("watch_scroll");u.$60(a);u.$61(a);u.$35.push(a)};a.getStoryFetcherData=function(){return u&&u.$69()};c.$69=function(){return{storyFetcher:this.$33,videoPlayerControllers:this.$35,channelVideoIndex:this.$36,rootVideoPlayerController:this.$17,channelInteractionsToRegister:this.$39,isFromWNS:!0}};a.getVideoPlaceholder=function(){return!u?null:u.$18};a.getReactContainer=function(){return!u?null:u.$14};a.registerChannelInteraction=function(a){u&&u.$39.push(a)};a.onEnterTahoe=function(){if(!u)return;u.$70()};c.$70=function(){this.$37=!0,this.$33.abandonRequest()};a.onEnterChannel=function(){if(!u)return;u.$71()};c.$71=function(){__p&&__p();this.$37=!0;this.$33.abandonRequest();var a=this.$14;if(!a)return;var c=["._23if","._23ig","._452w","._2i7a"];a.getChannelVideoElements().forEach(function(a){c.forEach(function(c){c=b("DOM").scry(a,c);c=c[0];c&&b("CSS").show(c)});var d=b("DOM").scry(a,"._2337");d=d[0];d&&(b("CSS").removeClass(d,"_2337"),b("CSS").addClass(d,"_3pay"))})};a.resetFromChannelView=function(a,b,c){if(!u)return;u.$59(a,b,c)};a.startFromChannelView=function(a,b,c,d,e){if(!u)return;u.$63(a,b,c,d,e)};c.$67=function(a,b,c){__p&&__p();if(this.$4){if(this.$16===a)return;if(c&&q.includes(c.reason))return;if(!a.isIntentionallyViewing())return;var d=this.$16.getOption("VideoWithLiveBroadcast","isLive");d?this.$16.mute():this.$16.pause("user_initiated")}if(b==="toggleFullscreen"&&a.isFullscreen()||b==="VideoChannelController/enterChannel")this.$19&&this.$54();else if((b!=="beginPlayback"||c&&c.reason==="user_initiated"||a.getSource()==="permalink")&&a.isIntentionallyViewing()&&!a.isFullscreen()&&!a.getIsInChannel()){d=this.$72(a.getVideoNode());d=d.top;(d>window.scrollY||b==="beginPlayback"&&c&&c.reason==="autoplay_initiated")&&this.$68(a)}};c.$73=function(a){if(this.$37||a!==this.$16)return;this.$14&&this.$14.setState({endScreenShown:!0,playbackFinished:!0,timeUntilNext:this.$50?t:0})};c.$74=function(a){var b=this;return a.addListener("finishPlayback",function(){return b.$73(a)})};c.$68=function(a){var c=a.getVideoNode();if(!c.offsetParent)return;this.$19=a;this.$25=b("throttle")(this.$75.bind(this),100);window.addEventListener("resize",this.$25);this.$76(c);this.$77()};c.$75=function(){this.$19&&(this.$76(this.$18||this.$19.getVideoNode()),this.$26&&this.$26())};c.$78=function(a){__p&&__p();var b=this.$72(a),c=a.scrollWidth;a=a.scrollHeight;var d=p,e=o;c<a&&(d*=c/a,e*=c/a);c=d;if(this.$10&&this.$10.children.length){a=this.$72(this.$10);if(a.left<=b.left)c=Math.min(a.left-2*l,e);else if(this.$11&&this.$11.children.length){b=this.$72(this.$11);c=Math.min(b.left-2*l,e)}}else{a=document.getElementById("timeline_tab_content");if(a){b=this.$72(a).left;c=Math.min(b-2*l,e)}}return Math.max(c,d)};c.$72=function(a){var b={left:0,top:0};do b.top+=a.offsetTop,b.left+=a.offsetLeft;while(a=a.offsetParent);return b};c.$79=function(){__p&&__p();if(b("VideoPlayerExperiments").rhcWNSEnabled)return s;var a=0;if(this.$10&&this.$10.children.length){var c=this.$72(this.$10),d=window.getComputedStyle(this.$10);d=parseInt(d.width,10);v&&(d=d||k);a=d+c.left-l}else{d=document.getElementById("timeline_tab_content");if(!d){c=document.getElementById("pagelet_timeline_main_column");c?d=c.parentNode:d=document.getElementById("contentArea")}if(d){c=this.$72(d).left;a=c-2*l}}return a};c.$58=function(a){__p&&__p();var c=!a&&this.$9;({left:0});var d=16,e=9;if(!c){this.$72(a);e=1;d=parseFloat(a.getAttribute("data-original-aspect-ratio"));a=a.parentElement;(!d||e===0)&&a&&(this.$72(a),d=a.scrollWidth,e=a.scrollHeight)}a=p;var f=o;d<e&&(a*=d/e,f*=d/e);var g=this.$79(),h=l;this.$12&&(h+=this.$12.scrollHeight);h=Math.max(h,n);var i=b("VideoPlayerExperiments").rhcWNSEnabled?g:Math.max(Math.min(g,f),p),j;b("VideoPlayerExperiments").rhcWNSEnabled?j=b("Locale").isRTL()?l+b("ViewportBounds").getRight():b("getViewportDimensions")().width-i-l:(j=g>f?g-f+l:l,j=Math.max(j,l));f=i*e/d;b("VideoPlayerExperiments").rhcWNSEnabled&&(f=Math.min(f,w()));return{hasEnoughSpace:!!c||g>=a,height:f,left:j,top:h,width:i}};a.hasEnoughSpaceToEnter=function(a){if(!u||!a||!a.getVideoNode())return!1;a=a.getVideoNode();var b=1,c=parseFloat(a.getAttribute("data-original-aspect-ratio"));a=a.parentElement;(!c||b===0)&&a&&(c=a.scrollWidth,b=a.scrollHeight);a=p;c<b&&(a*=c/b);return u.$79()>a};c.$76=function(a){__p&&__p();this.$22=this.$72(a);this.$27=a.scrollWidth;this.$28=a.scrollHeight;var b=Math.max(this.$27,this.$28);if(b<p){b=p/b;this.$27*=b;this.$28*=b}this.$21=this.$22.top+this.$28*.5-m;this.$20=this.$22.top+this.$28*.5-window.innerHeight;this.$46=this.$58(a);this.$29=!this.$46.hasEnoughSpace};c.$77=function(){this.$19.isIntentionallyViewing()?(this.$80(this.$81.bind(this)),this.$81()):this.$54()};a.isVideoAlmostFinished=function(a){var c=a.getPlaybackDuration();a=a.getCurrentTimePosition();var d=b("VideoWatchAndScrollVariables").noWNSRemainingTime;if(c*.2<d)return a/c>.8;else return c-a<d};a.isSlidingEnabled=function(b){__p&&__p();var c=u;if(c==null)return!1;var d=c.$19;if(d==null||d!==b)return!1;if(c.$29||!b.isIntentionallyViewing()||!b.getVideoNode().offsetParent||a.isVideoAlmostFinished(b)||b.getSource()==="tahoe"||b.hasLooped()){c.$54();return!1}return!0};c.$81=function(){var c=this.$19;if(c==null)return;if(!c.isIntentionallyViewing()||!c.getVideoNode().offsetParent){this.$54();return}(window.scrollY>this.$21||window.scrollY<this.$20)&&a.isSlidingEnabled(c)&&c!==this.$16&&!c.isFullscreen()&&!this.$37&&(b("VideoPlayerExperiments").rhcWNS&&b("VideoPlayerExperiments").responsiveRHC&&window.innerWidth<Number(b("VideoPlayerExperiments").ResponsiveRHCMinWidth)?c.pause("user_initiated"):(this.$66(),b("VideoPlayerExperiments").fixFeedVideosPlayOffscreen&&c.emit("enterWatchAndScroll"),this.$62(c,"autoplay_initiated",!1,!0)),this.$54())};c.$66=function(){this.$47=this.$48};c.$80=function(a){window.removeEventListener("scroll",this.$26),this.$26=a||null,window.addEventListener("scroll",this.$26),b("cancelAnimationFrame")(this.$32),delete this.$32};c.$54=function(){window.removeEventListener("resize",this.$25),this.$80(),delete this.$19,this.$29=!1};c.$65=function(a){this.$54(),this.$4&&this.$16!==a?this.$82(a):(this.$46=this.$58(a.getVideoNode()),this.$66(),this.$62(a,"user_initiated"))};c.$82=function(a){this.$23=a,this.$83()};c.$62=function(a,c,d,e){__p&&__p();var f=this;if(a.getSource()==="tahoe"){this.$37=!1;var g=b("Tahoe").get();g&&g.onExit("wns")}g=!!this.$45;this.$45&&(b("clearTimeout")(this.$45),this.$45=null,b("ReactDOM").unmountComponentAtNode(this.$84()),this.$85());e=this.$1&&(d||e)&&!!this.$17&&this.$17!==a;e&&(this.$36=0,this.$35=[],this.$38=[],this.$41=this.$17,this.$43=babelHelpers["extends"]({},this.$8),this.$44=this.$18,this.$40=this.$14,this.$42=this.$2,this.$2=null,this.$13&&this.$13.remove(),this.$31.release(),this.$31=new(b("SubscriptionsHandler"))());this.$17=a;this.$86(this.$14&&this.$36>0?this.$87(this.$36):a);this.$49?this.$49.add(a.getVideoID()):this.$49=new Set([a.getVideoID()]);this.$14&&this.$35.length>this.$36&&this.$87(this.$36+1).preload();this.$15=this.$16.getRootNode();var h=!this.$1||!this.$16.isMuted(),i=!this.$1||this.$16.isState("playing"),j=this.$1&&this.$16.isState("finished");if(!this.$1||e){(!d||g)&&(g&&(this.$46=this.$58(this.$15)),this.$52(this.$15));if(this.$9){this.$8=this.$9;if(this.$8.videoRootNode){this.$18=this.$88(this.$8.dimensions,this.$17.getVideoNode());b("DOM").appendContent(this.$8.videoRootNode,this.$18);d=b("DOM").scry(this.$8.videoRootNode,"._344x");g=d[0];g&&b("DOM").remove(g)}}else this.$8={videoRootNode:this.$15.parentNode,dimensions:b("DOMDimensions").getElementDimensions(this.$15),source:this.$16.getSource()},this.$18=this.$88(this.$8.dimensions,this.$16.getVideoNode()),b("DOM").insertAfter(this.$15,this.$18);d=null;this.$9&&(d=this.$9.videoRootNode);!d&&this.$15&&(d=this.$15.parentNode);d&&(this.$13=b("EventListener").listen(d,"click",function(){f.$56(),a.play("user_initiated"),b("setTimeoutAcrossTransitions")(function(){f.$67(a,"beginPlayback",{reason:"user_initiated"})},r)}));this.$16.pause("user_initiated");this.$16.isPlayerVersion("silvercity")&&this.$16.detachRootNode();g=this.$7?this.$7.width:this.$6;d=this.$7?this.$7.height:this.$5;this.$16.removeOffsetStylings();this.$16.setDimensions(g,d);this.$4=!0;e&&this.$89();this.$14=this.$90();!this.$1&&b("shouldWNSRenderToRHC")()&&b("Arbiter").inform("VideoWatchAndScrollController/init");j&&this.$73(this.$16)}else this.$16.pause("user_initiated"),this.$64();i&&this.$16.play(c);if(h){this.$16.unmute();if(this.$16.getVolume()===0){g=b("VideoPlayerVolumeSettings").getLastVolumeBeforeMute()||1;this.$16.setVolume(g);this.$16.emit("unmuteVideo")}}this.$16.updateSource("watch_scroll");d=this.$33;(!this.$1||e)&&d&&(d.abandonRequest(),this.$9||d.reset(a.getVideoID(),a.getVideoChannelID()),this.$91(),this.$60(a),this.$61(a));this.$1=!0;b("shouldWNSRenderToRHC")()&&b("Arbiter").inform("VideoWatchAndScrollController/start");b("Arbiter").inform(b("LiveRHCUtils"))};c.$60=function(b){b.hasOption("WatchAndScroll","isActive")||b.registerOption("WatchAndScroll","isActive",a.isActive)};c.$61=function(a){var c=this;this.$31.addSubscriptions(this.$74(a),a.addListener("VideoChannelController/enterChannel",function(){c.$31.release()}),a.addListener("WatchAndScroll/close",function(){c.$56();var a=b("XVideoWNSSurveyController").getURIBuilder().getURI();a=new(b("AsyncRequest"))().setURI(a);a.send()}))};c.$92=function(){if(!this.$14)return;this.$14.setState({endScreenShown:!1});this.$16&&this.$16.play("user_initiated")};c.$91=function(){__p&&__p();var a=this;if(!this.$47)return;this.$33.fetchStories(!0,function(c,d){var e=a.$14;if(!c||!c.length||!e)return;c=e.getChannelVideoElements().concat(c);e.setState({channelVideoElements:c},function(){b("setTimeoutAcrossTransitions")(function(){a.$87(a.$36+1).preload()})});a.$38=a.$38.concat(d)})};c.$87=function(a){var b=this.$14?this.$14.getChannelVideoElements():[],c=[this.$17].concat(this.$35),d=null;c.forEach(function(c){b[a].contains(c.getRootNode())&&(d=c)});d||i(0,3965);return d};c.$93=function(){if(u&&u.$50)for(var a=0;a<u.$35.length;a++){var b=u.$35[a];if(u.$50.contains(b.getRootNode()))return b}return null};c.$64=function(){__p&&__p();var a=this.$16.isMuted();this.$16.pause("user_initiated");this.$16!==this.$17&&this.$16.abortLoading();this.$86(this.$87(this.$36));this.$15=this.$16.getRootNode();var c=this.$16.getVideoNode(),d=parseFloat(c.getAttribute("data-original-aspect-ratio"));d||(d=16/9);var e=this.$46;e||(e=this.$58(c));this.$14&&(e.width=this.$14.getWidth());e.height=e.width/d;b("VideoPlayerExperiments").rhcWNSEnabled?e.height=Math.min(e.height,w()):e.height>o&&(e.height=o,e.width=e.height*d);this.$16.removeOffsetStylings();this.$16.setDimensions(e.width,e.height);this.$52(c);this.$14&&this.$14.setState({playbackFinished:!1,videoIndex:this.$36,width:e.width,height:e.height},function(){b("shouldWNSRenderToRHC")()&&b("Arbiter").inform("VideoWatchAndScrollController/resize")});this.$46=e;this.$16.play("autoplay_initiated");a&&this.$16.mute();this.$35.length<=this.$36?this.$91():this.$87(this.$36+1).preload()};c.$94=function(){var a=l;this.$12&&(a+=this.$12.scrollHeight);return Math.max(a,n)};c.$52=function(a){__p&&__p();if(this.$46){this.$7={height:this.$46.height,left:this.$46.left,top:this.$46.top,width:this.$46.width};return}if(a){var b=a.scrollWidth,c=a.scrollHeight;a=this.$78(a);c=a*c/b;this.$7.height=c;this.$7.width=a}else this.$7={height:this.$5,left:l,top:this.$94(),width:this.$6}};c.$88=function(a,c){__p&&__p();var d=b("DOM").create("canvas",{className:"_57n6"});d.height=a.height;d.width=a.width;if(d.getContext&&d.getContext("2d"))if(c.scrollHeight===0){a=b("DOM").scry(c.parentNode,"._3t5i");a=a[0];if(a){var e=d.getContext("2d");e.drawImage(a,0,0)}}else if(c instanceof window.HTMLVideoElement){e=new(b("VideoFrameBuffer"))(d,c);e.updateFrameBuffer()}a=b("DOM").create("div");a.appendChild(d);c=b("DOM").create("i",{className:"_1jto _bsl _3htz"});a.appendChild(c);return a};c.$56=function(){this.$19&&this.$54();this.$16.pause("user_initiated");if(b("VideoPlayerExperiments").pauseUpNextControllerWNS){var a=this.$93();a&&a.pause("user_initiated");u&&(u.$50=null)}this.$83()};c.$95=function(){this.$16.emit("WatchAndScroll/collapse")};c.$96=function(){var a=this.$88(this.$7,this.$16.getVideoNode(),!0);this.$14&&this.$14.setState({fadeOut:!0,fadeOutPlaceholder:a});this.$97(this.$17,this.$8);this.$18&&(b("DOM").remove(this.$18),this.$18=null);this.$13&&(this.$13.remove(),this.$13=null)};c.$97=function(a,c,d){__p&&__p();a.pause("user_initiated");a.isPlayerVersion("silvercity")&&a.detachRootNode();d&&b("ReactDOM").unmountComponentAtNode(d);c.dimensions&&c.dimensions.width&&c.dimensions.height&&(a.addOffsetStylings(),a.setDimensions(c.dimensions.width,c.dimensions.height));c.videoRootNode&&b("DOM").prependContent(c.videoRootNode,a.getRootNode());a.emit("WatchAndScroll/positionUpdated");a.updateSource(c.source||"inline");d=this.$72(a.getVideoNode());c=d.top;d=b("getViewportDimensions")().height;a.getSource()!=="permalink"&&a.mute();c<window.scrollY||c>window.scrollY+d||this.$51===!1?(a.pause("autoplay_initiated"),a.emit("resumeAutoplay")):a.play("user_initiated")};c.$89=function(){var a=this;this.$4||i(0,3966);this.$40||i(0,3967);this.$40.setState({fadeOut:!0});this.$45=b("setTimeoutAcrossTransitions")(function(){a.$41||i(0,3968),a.$42||i(0,3969),a.$97(a.$41,a.$43,a.$42),a.$44&&(b("DOM").remove(a.$44),a.$44=null),a.$45=null},r)};c.$55=function(){var a=this;this.$4||i(0,3966);this.$14||i(0,3970);!this.$23&&b("shouldWNSRenderToRHC")()&&b("Arbiter").inform("VideoWatchAndScrollController/exit");this.$35.forEach(function(a){return a.abortLoading()});this.$96();this.$45=b("setTimeoutAcrossTransitions")(function(){b("ReactDOM").unmountComponentAtNode(a.$84()),a.$85()},r)};c.$85=function(){this.$4||i(0,3966),this.$33&&this.$33.abandonRequest(),this.$36=0,this.$1=!1,this.$31.release(),this.$31=new(b("SubscriptionsHandler"))(),this.$8={},this.$16=null,this.$17=null,this.$4=!1,this.$35=[],this.$38=[],this.$14=null,b("clearTimeout")(this.$45),this.$45=null,this.$41&&this.$42&&this.$43&&this.$97(this.$41,this.$43,this.$42),this.$41=null,this.$43={},this.$44&&(b("DOM").remove(this.$44),this.$44=null),b("VideoAutoplayControllerX").setShouldAutoplay(!0),this.$2=null,this.$23&&(this.$46=this.$58(this.$23.getVideoNode()),this.$66(),this.$62(this.$23,"user_initiated"),this.$23=null),this.$29=!1,this.$46=null};c.$90=function(){var a=this;return b("ReactDOM").render(b("React").jsx(b("VideoWatchAndScrollContainer.react"),{isDrawerEnabled:b("VideoPlayerExperiments").rhcWNSDrawerEnabled&&b("shouldWNSRenderToRHC")()&&b("VideoPlayerExperiments").rhcWNSExpandToTahoe,isLiveVideo:function(){return a.$16.isLiveVideo()},initialPosition:this.$7,initialVideoElement:this.$15,onChannelNavigation:this.$98.bind(this),onClick:this.$99.bind(this),onClose:this.$56.bind(this),onCollapse:this.$95.bind(this),onDrop:this.$100.bind(this),onGrab:this.$101.bind(this),onInitialPositionUpdate:this.$102.bind(this),onLoadUpNext:this.registerUpNextUnit.bind(this),onPlayNext:this.$103.bind(this),onReplay:this.$92.bind(this),viewedVideos:Array.from(this.$49),videoID:this.$16.getVideoID()}),this.$84())};c.$83=function(){this.$17&&this.$17.emit("exitWatchAndScroll");if(b("VideoPlayerExperiments").pauseUpNextControllerWNS){var a=this.$93();a&&a.emit("exitWatchAndScroll")}};c.$98=function(a){if(a>0&&this.$35.length<=this.$36){b("shouldWNSRenderToRHC")()||this.$56();return}this.$36+=a;this.$64()};c.$103=function(){var a=this.$93();a&&(this.$50=null,a.emit("crossfadeWatchAndScroll"),this.$51?a.play("autoplay_initiated"):(a.preload(),a.emit("showOverlay")))};c.$101=function(){this.$19&&this.$54();var a=this.$16.getOption("VideoWithLiveBroadcast","isLive");if(a)return;this.$24=this.$16.isState("playing");this.$16.pause("user_initiated")};c.$100=function(){var a=this.$16.getOption("VideoWithLiveBroadcast","isLive");if(a)return;this.$24&&this.$16.play("user_initiated");this.$24=null};c.$99=function(){var a=this.$16.getOption("VideoWithLiveBroadcast","isLive");if(this.$19||a)return;this.$16.isState("playing")?this.$16.pause("user_initiated"):(this.$16.isState("paused")||this.$16.isState("finished")||this.$16.isState("ready"))&&this.$16.play("user_initiated")};c.$86=function(a){__p&&__p();var c=this;if(this.$16===a)return;b("VideoPlayerExperiments").rhcWNSEnabled&&a.addListener("WatchAndScroll/collapse",function(){if(a!=c.$16){a.removeCurrentListener();return}if(!b("shouldWNSRenderToRHC")())return;b("Arbiter").inform("VideoWatchAndScrollController/collapse")});this.$16=a};c.pauseActiveVideo=function(a){if(!this.$16)return;this.$16.pause(a)};a.pauseActiveVideo=function(a){a===void 0&&(a="user_initiated");if(!u)return;u.pauseActiveVideo(a)};c.playActiveVideo=function(a){if(!this.$16)return;this.$16.play(a)};c.registerUpNextUnit=function(a,c){__p&&__p();var d=b("DOM").find(a,"._3iqr");if(!u||!d)return;u.$50=a;u.$51=c;b("EventListener").listen(d,"click",function(a){if(!u)return;var b=u.$93();b&&(a.preventDefault(),a.stopPropagation(),u.$50=null,b.emit("crossfadeWatchAndScroll"),b.play("user_initiated"))})};a.playActiveVideo=function(a){a===void 0&&(a="user_initiated");if(!u)return;u.playActiveVideo(a)};c.$102=function(a){this.$7=a,this.$14&&!this.$14.getFadeOutStatus()&&(this.$16.removeOffsetStylings(),this.$16.setDimensions(a.width,a.height),this.$16.emit("WatchAndScroll/positionUpdated"))};c.$104=function(){var a=b("DOM").create("div");b("shouldWNSRenderToRHC")()?b("ifRequired")("RHCVideoWNSController",function(b){return b.mount(a)}):b("DOM").appendContent(document.body,a);return a};c.$84=function(){this.$2||(this.$2=this.$104());return this.$2};return a}();e.exports=a}),null);